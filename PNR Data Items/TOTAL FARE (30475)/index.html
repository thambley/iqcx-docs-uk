<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
