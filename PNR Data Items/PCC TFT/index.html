<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
