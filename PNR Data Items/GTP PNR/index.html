<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
