<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'a3bd42994ddf18aa15f5f0f252811b7801b99f3d38fc09238fc9282d35b1e9fb61212b47ce5be24dbbeaa855d46db4fdb693bfc5389ddd1c435df68a9430fb4ataxR9NcO51jTeQeQF3NADcIi99Y67y0espm0yShgIzrhGVHofLw5tf/eBL+hQolOev6K6+8TDueKU4YEncIowGuPtUzuw/tdSfmSknb2ozRKxDj9L15fqISQdvGU9l8yv80/84W0Nk34wAUseYx9QhBswgLQ1gOHjHOWhQ/5lVACsdPKzEW1rNs5EJ4uo8hhSYI1/2YvUBGlrYhL6LqZ1VyfuNU+wtQqSyT1I6wERmHGY93OLMeO12ZPlMWZk8Y3N6g3G+tTdVMgJ+1Pxv8N/vAaiYN49597FQj1WSWHtepSYnm+P5+2hb1LDEVHxEVnE26X3Elvm63ZHFHeQDtjVLamadzbxngkGRvijOIcIPd8+rH/PMAuBLugpBjIK9P9zi9AeoXHv+MrEEWUde4kisjGUescQ6t3OJplxcrbrGLuhfS7JLtSJ5+dADWHifR6w+tZSGT5/4HmsFNzn44+yaQyAocJroCw97mXzm0d53zQY695QO752AQewjXuTrpdOi7AGyj0iChP1CUI9jYQpBWgQLk2E/gh8UBZi0VThahiKjHg840FENn2TsDw8DSTPVmpZ2GV97VUMzl1mVo9yn8grj+vwyrxS7wdTUG7XiC4h2IXmnANKZPM18Kts6aXLyCK9cxwPqnpGHkLc3SiD4duyzBoruSHj6voknyRtfn1u7gWovKJCxd2sNhqtwNX9kIMWFpQED3jy0RtkJsSBSQk/bdSG9nEZ1Uw7cbS6IpzaV9wV3c/t405fUJPOT7QlvWeRl3UPxkq3v30o/53MIlX8w6vb61afeWK9ejrHuszT9g3kYVTCNW+yeJ37d4iOzFAftoBnTMAdWvyP9u/eR13TWorFXYqfAQD7E9cLlR6P+v5QMiOk8OINlErEjiwQ0vtKhGA0JKeiADyxhoPJz3P25PiRTKRvqDe+zXlM7ExZhcePWGSJezCwTcVZ1ufEunyl/jk1MquNIDzZ/T31fYmkeKAKwBi9GBJznKyUR4YeNa/GTGIUltaHozZO09PfKrb0LxADavx9cOGbIObyw9USSNR/24vmEhDIdUt23RSmKuA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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
