<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
