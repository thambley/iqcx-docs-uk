<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
