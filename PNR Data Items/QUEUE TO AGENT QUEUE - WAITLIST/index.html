<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'b55c1e4db3cb9e7c3cbb0ef3421913ca9ef951365626e5af8492c963e9cad9fe95f446784baf1513af9e733baca415b444348f84cb64c00cbec7cb124bd55b5efjO96U63E5+KhP2ZdpPRarbUaOFHwFKX0VHlkCwT+lmKPmaHCArIRpIC3snUiXzWBmFarFu0/Nj4QGMxBKa9Ecr52M/5pp8NC1CEhY3ac+FiUdduOh0YMT2JH987VlGsZ3vqp3WGyFegaUzNeHfv+Zu2tawID9AOW101GoudISyfN/b78wt14JOqKyT1UjIECo8x8NwaS9QseDkTJXOyQDJnxM7jG/em+8I+S4M4UOzSWEA2ytRlYEY5NCTTXpjktAPd2LpDkpS458yyswZzEOsbHsA1hH26MfFTjUvdMCV4B1dCFTCs6sF12hZwkC1LDcP76DTVRZgSq+b707TcAjIKiduTAWuiOrpQQhQGvFtUzzbMzLlrGjGimRx8QhctaKiW2YIuQhJJw6luGCmb1rwR76Sdo33n9cDpS8MJELGKwZ+OVlCZktfbgbkyDDG7BOzD6LbbDBvOENBPDyfBYhqacomnO9BdPnHQ4dnlwagFTDzfumedzzNbiB6ouLLaiLZl5W32Cz8HHeBZqTxTCEoZrwAMM1eZdyZq6McXevPYKcVgZi2EKsy2B/euA7yAsZbkUscWCfvid56bIK++SeEKelS7xQE0zdahWTtRqrEPNcvz+iYnFdgVZNkG3TjiklhgefSwcA7XyJtSeCSH5ADrTrKc6Hsh7Bxji/suATAI2Pl8XZz7A/+mo9IZzrTH8+4LN2ZQwM6ADebSkNQfIQ2s0FHlsA1yOC3wTiTFuW5A9px/dSE4HICPZDY9xUuPyffUZoByQvdCSRMm00N/XVun5dvCwH47SyD19wk23qNYm673a/awZfhOBmisBBNn8jvgQdhyF8TFgrYMrQzW+a6Y/m+saGNM/twyW0M26bh4HkFnQi9X45aI20raa6vEyKDe8AcDKTuCZ1W9elED2qXJF4ChETaOcaM3Z7mvSTJmzWx161519LnkyZKyBHv9c22KfJ6tW7vnZQ6eOUCp/+IuDmGbPYcM/JvXhYkWYOuuygQZPP30u2sjDPE3IjuZqT05xlH4hhBM0soTg0unKhzye9FgVeK4GNseFpH12GwadYUl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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
