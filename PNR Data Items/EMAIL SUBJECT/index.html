<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'dc69b33964cb441611d0f0b47398bea8ddbb2c0e59deff176352ed03b34468fc8fb139eed30452c4af232437aa6b9fb441bbfed54cf8592142485423404e03b7MTyd1rVPTW+MiOaDt7KbKfzvwfPRRi23PGi4af2b9t8Ma1Lbx9Sh4SEkqWGWEwe7VklhMUy64PZBNIEaH9PfUOvyz8B/HhHot800yGw5aD7iaeZVjc5N8p7TTSUCSH2my0mEi1LAu73kV9Z3VGimWERA1OnAisntYukxbfkK3a+n6bgXsyQdsKlE5nRCRG+CqgK4CVQghHfqrebXkKpf031r6RVFJ5j8e3WACb9TbUPAjNoeYDCfvVd+2Q3l5XLH7NNpvBsqeLPp6ClKnWr0df5DGqJCer5TByjRR+s3ws8CMyVpXtJftARKXTN3X7rO6WSJi8ijPMVEClwmvBv5AxN5Ys7d0WX/OM3t5jThqEv34OpkPXFSSrqHXGezBf1H4EkO3CGToSvj50TRCJkJKIUYZXWE34gjp1Smko+Piyz7nnA9DS3CbZfir8f01qFGEA8IBXHE22e7B8ga83kDEvYUAr1qI85beJTCZ2Z4U4/eNR69vnrJMNDEurFrPl3/vCGDCERbkreVZ2zIP4DqEtgwztmg+ZoH2xkGvLQcBxbIpFAvXTV25dtuUiD8kTgG2upBtL3FJcM17rJcj2sYuP/5K7zDRX6IzB4O+d1zunhkjT9Z5xBYRHufgkUd5mH6zKO0BfyVJQen1sxB8FmaXFGIoWQuVwkMix/pheNlAapXfpKIGHYoHIXvLgZpyKWxl3cxzEd9W/jv3CgfJ6+f8PBCf0C4MdXw51xSKlyv/09muupJDAWavQDBdL5rMPRE0PX3GYYrZR1nhCKB1yVz0368NazB/qebs3+OGi1B4bXKtmwtR+OKxWVlLYmFQds4waVDS3AiMjFiv+iZlnamoBWHgmzyJX/RqAQbP29ViZOMf/bzaVpwYyC6Zs09rY5sjZZks+5/bVfu7lcZUKmMCWojsviJJsR0df4irb78AxxNsX72E1oAJfvwkOTubebmC43+i5vfbRq58NdY4qyva4LPlljfWBG+HEtfTEp1hQBk+Ly6N5UxvunI+uU7QXgbMCKzh09CS2lCy/t6TGDW4diL3zzi2D+c+8w56CxIxvxhh8JG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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
