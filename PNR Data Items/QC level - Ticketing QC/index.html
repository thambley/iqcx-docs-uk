<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
