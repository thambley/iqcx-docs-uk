<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
