<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
