<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
