<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
