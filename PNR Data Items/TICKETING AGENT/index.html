<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
