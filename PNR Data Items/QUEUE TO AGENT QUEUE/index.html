<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
