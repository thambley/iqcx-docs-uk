<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
