<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
