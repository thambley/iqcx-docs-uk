<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
