<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'cc5b906e36f80bbf5d4b05550a669e1252234a7ee5d28fb52a48cf5a4112c4fb38e3bbbdd27db6a3c6deff482f759c876e93edabd4fec9eba84e63fa43a85925Nt98/zfsKIvJCWTH3pELDz3/i/XkqbDOtzRlKVMFYpzj4qBCi+WGVOMPZWSz/hWf3chp+CyFhfKuPLdgPpU31X94tUwoz/RAJZo0utk9eqRDo9WxLFzftm8Utvi63B8a25XkjaFeI7H5VPKGHmTVW85ABq7RTOYzTN4qfOupKWsgTjAItCaat7kJtreka8WjMqZsIqYXR9COi80xPCcU0lQNSgpTk2h5DLW3ouE0yhZl5WMTIt73BHd65jQEBg/Kso4myKoJChauO5KDBfgekiUVojHQQg/HblnyWBPom+ITPXahtOKBmbGzaHvpE5P14Fz6fRWMjGXs4zQjWJhWjMl92sBLzemxiMw7+aH2sT91sgyhKSj8rUjUecGKkavJyLHlRt36XlVhQRExi3c/McfqY1uA+C4IcLd7SdbKiP1wDFHc/3HQIDNjENsckcdSlxsq4YFaJaSFzXL2lABo4CXOed4yLI5zFjlRKskmi5um6TJIYM2KnbSVPx+9LobSCmP6pwLNlr9JdQfhtRfSnq0nKEkH23vFCZEOMk7CXqeCNLnBH6pWkrhNLx7AJOLPMQK40PMNE9rqTC0YLPMjJGW5gxMO3pnW7azCLZhki+PeblktzUu8/rHdF23OmF1+upaTt5mp5dYZ2EFrAEmiASNvHPwCLHN3umAlovlMVJ9iCizP6i78gwRH5qbxE7QoBQ2NJh3eRfYAdtnQZViW1tAKV8SCklcCxoBS9h6f4VFEZ4IpboGqFYi8hiU8KrQG0pb/+RnDNrCuwT+i8nf/5J5MRPF+/lW1IQFblQapdFSC1E99BGOkgFvdVSDpNEM8qkRMLnONt5wQf1J0U0xYMF7O3JsFqYbh1h8qX9i/g2re47AXnKh/wDf1ILydctL3puZOD9z5DfrZfpwfCOdfi1yr5xm72lpFZoAQImvq7GVhPB31eiuJCTC3tbzSTT6ArFny9/tA7IV/bXC0zZ3X1TgtwbiyOp9wgewgEqWiatU30j6Uv3mHyGYdlyagcXdtA/r8rKY+4rPRiR/GMAb+izCvKIFS6N296HxrJ2+Eo2GItb0v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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
