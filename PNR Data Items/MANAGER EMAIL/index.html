<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
