<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
