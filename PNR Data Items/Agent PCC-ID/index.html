<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
