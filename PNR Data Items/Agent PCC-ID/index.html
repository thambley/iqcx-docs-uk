<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
