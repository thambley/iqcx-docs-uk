<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
