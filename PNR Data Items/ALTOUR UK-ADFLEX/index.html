<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '8b672332e5429d111dc056b7e45956bd158df55883d97f2ce2470c0bcb114148b03e0bae626d36c66846b674449f4342474bf7036e3a6d68abfc9e94975c6886ZfStlBm+OYx3yD4Nz/wcx3VxNqV9UWlXG0XOtrOW2bXBmqGBE9bPwO3rFY3Pgnzv98rKR5DI2U3OuJWWHZc6KNIUpKVoyUkYi6NfarajANSPgYNvxCzzxN6oPviaAbl3QQaD0dkz3SLmDLtaSPmhbstbYL54FGhMMm7r5JK6UXS42i6T0wQP+gH+eXxisKTNsCOGp8+KFa/yfXmym7+aNeuBRlsMlpj1HOkYNOrEwZyceLSdNC/rMavO6xH2cYCSNQ6l++cEDhB6E3GWpLOEGPqxjXEGaWZExfWBXLV3gyjZ8xnjHfJ3zcnD7pSxanh3xD6PSOh/j30JvJwleuJV4EY8qySX4xvEoUychuirgXHhgJ1A2K91jf+ImiNesF2A1vvvPpVHiBhHtfwJ1qvmIT+8V0JfTjK4dn04uH/lXjZXGIMFWAr93yguHVFbyPfOPzwu8NNeA27giconmAXVWZXNN1b+sPC53IBSU2lIJbOmd1NfDgCwTUXOpXgfXWd96FbVicTE8CHp/qIQ3lElqporfI1AebUAx+ghG7R1IulTNPOF+ycUixeg+OXD/8TijKPNdOrR4bvQ/+zY7zo1a+/nVmA2hk1OyHrZ3NJecKUDaQYbuimXaS8wPi2BWdfJOVWfGRUOvIY//SEztjJpBsb+nwQ7MDKiR0/tggoV9A3l+3DdbH/LXvNVniq2fy2BuIxYivh4AUYLzLWI+VlhvLxU0LPRBkrNDOn6YNgXQituoSzZf3w6b+uNhK8mHcjRNQCZIROSOzWYKJo0SCbswWCs8eghM3dAvUJcTp1FWehPwMSBCSYmbEyhLXsI5ZC/dlMYDqqXYLzb+j18nKlRG03ieURD6+5YojTG5DwwYMfiuGZ/unjJQKrZMZSEYOrzktKkfVNVcjLtOjfcKjoM4NxEvF0ZgF6tWZLInL4TAulFQaupLJQwp733GG30fXEJ5u1Qh0oDbg1WROHYDoGVeOfhac5SG0xrZAqzxiofjov6TaGjUxC0vQsuV5uWrMBZVpySBSXsD606h12istBROddU8c6SfihbO/bb6+MdeTV310zJ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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
