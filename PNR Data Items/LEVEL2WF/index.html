<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
