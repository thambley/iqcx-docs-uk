<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
