<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
