<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
