<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
