<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'a877d4a93d825d58efc4115ce429fb626a16c7ba8689c77333f3ba01f4ad1515c7d82dcb92472d0859a132f77012af5bb732d5a1bd6b44e79175a74e6bf7f70aq5E4Tf9pLyuxDDDATWfMkAwSvPOfeb8fF/HQKFwyJJYSFngt+E6t7svAiInXB2DF/tNY/+tUbrZKf/ZmDVgoX/t1dMTNGahceoyzfmGh/WmODf6jX4aQmOwfdMSk7nYuOrfkzjPSiyTIxsbf1CSGrpWfmYdXzXVXE9IF8oZd5SWKGK521gBMHYXQCg5HxRqVzSdc4ZWT3w2jwnoZ/FKaIy0gfFiFWqer3WQT+Dakjva9mmDIJDIaVaB9cVbNl/CZd5nBU12ZYgI5ayCOw19s4qDN1avlHqRDG0xIZ657RSh8XWn1pMLXr0LB3gjxaLnre1BcwKW8UQlBO+RVYmQ1OBpvj169fCbvWpOoivfdkXT19V5r19KHUgAE5+46nv0AsEVPfbXOncne+IyvLXfaFJal2xdmUjPm+r9MsiRNEGrARX5oIupX9aMKjlVHws1SLdYiDnghWkO/Mtx70/z4xc4J0uH6AJkGGiDv9AEdzwzzwi3wOWMszmZGxmJ1ysItz30h9bYZcgqAtnz1wspNzhRxP5FAh12zzp16rR806ZwzfIQ9oL8b5Uvp0WhHIoyOSzVYCZnHygyW5dytn/Wg1CQm79SFUQKPE4fp1zTPQpxFw0YvTFa9qY+YFPvtUa6PFMDHGFioquGnDe4jHX7UpUeNllWQAJMOWo2fXZ1zzLZIij4VPQ0FC+RxupoFBrYd4Q4giFGDVeIlAcehexHw4ognxHURtoDW5kLcgbrfERivIrEp4L67BlMgagw7pwVQ/jciiSJNna25UotBVkvQtkJVovMKbxM1CaeHn9064WPUHjgBaOYuVfrL2gE5a1Ow3zGilVOTChr/BWth6nGdAcYmCtXKTfv+9ye0qjGidC61vNcWieMfnHA8u0ubisO1Cbmxpp7A7TEXsY8tiQELs8DYoYO0J2Ch+qam8sMpo7oHkSNncoutrcoqvsWRgtylEG7EBr2O3/iTZ2ST0bUM7A/2mDa+eCsTrDt5s1yyxk6yUYDNzScC9fGCq4BiH1b+Gu+ImZUNLlzpOMH70El1TuTbLlJP5bJZW5Rsv+j/D0R4k1zvhlhTaBgDmR94aPCrm8LCU7ZV6vrzpNK3aTovQOD475JKeGJz/N5KJUABqnz40nBcQwS1srooo4We7eaZBJ6DE/3vEfiYvJ3DBg9ZUTEuPTMl86rearO18C300qZiSSB1uWzHyVZKVTh6CZDXPHImW9JqARDGQXcamu3GTT232q1hg5TcWuJxzle6afbhfggxEOukwgGHWobi925MKEQxNw4f3ivAUnNrOlmIADtA0gx1xeveG62B5bPXCRPp6YfOeouHSsFfx/3EmNOnYLo6Vup3p3CirnvoguwdHkYzAImjANK9YRrhFgffAKHSYfi0df4Pys3FSuF0F+Vl+ehRZFAYFmZ7dtYheuQGAn5cF0uZlWYb3rQPEcNxejyz7wzXXdVEiWroE/d6WQ33asJ4fQAj16ODq8cRBjUa/HRxJJzWQVh4cRyCrWdgnVapJ116vrM0j+NM9x5CWwJCxkCfatpSa+wFwWfG0vKFN9+n/RY8/HNpFyDYkyScz+U95vwq1lO4z1sAp5zcISxK2N8ESer2IUADazbgIVTdq0Tt3MEyVNAzISkav3Evihe84CVJamIVd3OLGnOmYZpUqpicCP+4uDIfffA8rMHEadEivWZQ0RxrcqcRUyztIiiJ7bCVFDx0e18/AIugrv8fyUH2c6cj9xjn3eM3zAyhJU2mUKCleWB9VAy7qEnEkzYmetEyVbZo4DnEoL4vaaGx7nEV3GVH7P2qj4WnJxMJxlVHsCu3uOClU66aOXntA4QrhLUEsv3ak7Ee904T71NjoyJi+lL83QtDwvUf7S2tarphhxC9sx7YBuOqB4L92b9TqRls1PSXYph/yp7KkIXsUhXw6q6hbeehOpFW7ZjcqpNx/eE9HHaDAzcjCNw2Z6zpDcLxpqQGM8su/yk/ZWvt/fQcnssNg/kSzslf/LVJK0MaA5XjsAKTdCnLNM1JynZ4JW1sUrWwQOsFFCumcfLyAbrRSxHhJZCqxgGpVyKAzot4U9c9EWAVVsvdiXgbZ07aSt1Iw3F0RH0B4HnPDMjliv0DRRmS5BaRgpdudBWP2GsJLoA2y496mA3twISPaZGJd2bmsYhuRNAY7nJ0S0yvCkzhSZwJl81cpLQHF5hlwM7bPO2Nt2vfr4fUV3tm/QWoKOOTm9simGBxkaxxw9MLs/WQyZs6fvs1RCXnGIZ+llDYSUXRq/A7zWvGBLREVsvvkR5RaJZbubKACloC1YeaRmePQN9vSk6mqn+Tc1UOh06SpF0sLy0dJy8nZmS88V6HOuQFFxvjNQwNA58qNrJMWdV63fGRaHROZx8QLsOqJQmJIkGdFg3qORHKJWWE1jYfSJ0CtylPUd+t5Xt83geTDrFNM1iI1EeXT8uTQfMj0S7LkhktSl4rlGd73lZvDxRqJrxWmONqPc1abPlvcfr+GIClhfZJMzWoC4JBcQqRcBDdFNaDkhk2FhKDBlZuKc/Yl1oIZnE+s5isv7VxXlSUl+xC128akLMPr+DRTYSV+wdyBPkCDmkcYAVrzVq2tsyFxc8g80RpjSKItUzBV1V3416l5XpONtf9xiya5lMfHSjc1BlTimLPqp6B6KWuPHu2rom5U3jraaCOkKHM33SFZqoOZzciNuvuukBF5UkE7oUEdjjfcbxzAATUJHmgFBqB3ydXevAAY1Hz2oTnd6DYkQlquMIzMzKYMV8gspJtzdu2xfap8wMLLFsPc7HOebwvhzzeyinWUD4/2Xy00aGyhNSVZtccaVGqb08jB4YlPuA/eq0f1sbtKqNIu5Ja3ZVPkj3u+HeXL/7Nm/IMo1SF9jKJVfbJKf52AwSDjI7oJ4vXJ6jRkL0ZK2+nDFLhghPOMkBxGfgGjD43Nqrlja3tSgPSIybAMC2B3s9syirA6g0U5IDos5pRvYXLXefWGA6bj/jrZtu/JKWAUu6rPVgqxTpdvwJmRwVAqAJLvSmdSOluEq0E+1PdzwLU0/lnRcDSxXTyB/GdWx/fB30i+xSKPy3+pIJ5IX/cpF4w6v6f+VhRZfWJasUfK/LkJaHN5zDFxrNoMwY4J8/xATymftsLPb2TDJk12zsgrGFxwvd1qG/BylLfkcDZAftdrAglnkzwf6bMfpeK6hIhyE3kFx0pnx6IMjPJ61+vKNhEq8PPTSttCTkp6cW3wxed3zNa44L3dH3jMz65xsdU1Z8/OddNKQgXZi8MS3g1UDUUKmliElc7UDBW0CUHgzJHT3JGDsJiJXy/3tUP7sResy5zEGgLam3Q+7ezMXApDQTlz/XRUUaxwl/pXLSOmLGOiKWggELKGD5iU9h/xuRrNUiRzOMdgwHKRc8Jg5/+ZDnr7x5v5BCMx8fmd1WtqZDsYeHR1WDUgBS2FqI/h44YHAZ2yYYBcH4STBhvh/+gl+ti5XZHkw/krm4av2YloL/CR95w9bfvTUqg2zg6HKZxkdU1PIplJfoAe1f4aZja2VkqJfVNDrlmpMlPolVX3aGRdxTVpA5GEyw4cO6+pubnLOxw/V7SwmGhOQblvjKHTJkKCqgq+vu8RlUbbpLii+5VHT2kiz9bA6JiMgMYfcLLsZf4d0akNJbDU6lACSDV4A5J9eA49gOBygnGqC5o4biqyWOFC/U=',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
