<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
