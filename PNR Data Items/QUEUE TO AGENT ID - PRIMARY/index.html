<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'add3348483c88ca001ac9136360d9638728fb1f6caf74a9b16e751945ac589ae59639c8eb00a0ee6c293e7ba304c0598af7ad1ba60c1c173c7387657994db21dRUY0rxZ6uBgU/ZsT9f46M5x5NWWdyoq9glXWQ2oUn35mKzlHrBYtq4qm7QAXak4gyK7+oZxbQD3BdNgE/B0yMAxPXvuqQfY+PnFx0SwCCde7tfy4FDNbK1CWwLWXNbtPoX7qP3+wcPu3eBCa7intGtCeFdzV2XV6URaZgI/4D4Rj4FEwZLUl9hgppT8NzKGhc2DT+qVrlI9YZ++kJ5ZVa1J7QvOpSbiKn5l3MCQt892fM3ItSbDulXegEpgVJPgJGYThugYvIwOeLWjBdH+tTo4VexFKq/NlvyiUcaEecVXrrG4v/LS+DpC1rDS1r5qBu00KIJqXWkdDOALBViA0W3C477Xrt8oMANdVPC0ZOUZx1yBed8UdQm4WrR8iOYyfSba+BnJo11QEGzsbG5ATh6Ym30QuE3ernVJizXwdZV1oa84pjypqR2516DeRl10ARnSRiz8Ihy2i2vCMCtuSWKQBfv8FupjshuZvxFdJSmJ2I8vnc2apa8XG7osUxQoF98wmzctTKfognNuSl/VmAN6oBGdjzByXG/UnEWMqjwAUvQOjWrxIwFQiKY86A8YW74YtB79arMErckMeayF+aVnrup291hBW+99wD8FJAccb/uNQp4/3KZVoBZKUe24mrudIHFoxpZ3jMcAMJqV7LHibWvgV8vs09ht2P9Cf+J9hRI/txyP1tF8MQ0FXjEHq64VoCAFSd6W34kUEtJ0EYpayssplFIWp9qtkLMWMZOsuqcjoKuBnFePpZhIp1JKzL+wc9OBUQaPvYj1OUE/yNDb9QTGJZjyqUb4jTWLBDg1oSS+Wa/y6wKAVqMcp4CJMChPq4erDnY9ZBa09NJEYE2dFp97ut3FCOyCJ8ir8vu6O6yLhPKh1ypXl4MKpzGv+Q3pSEe3qys8uzgfSNr+BsKKuFU435NOV29+su832Jkx9aT60zoYzg2xUJQyEtaPXOfdk9ppzwK42gKyEQSANjILyfNAj43j7vDumk/m0DjXyebA8+QY3eMAkgSxglIecaDeUPzIeP6HI20VAFgYqFhOXfre+fqTC1T5RyLBi+hOuLthe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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
