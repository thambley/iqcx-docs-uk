<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
