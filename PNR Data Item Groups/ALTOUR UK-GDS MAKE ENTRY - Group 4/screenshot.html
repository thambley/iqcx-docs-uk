<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
