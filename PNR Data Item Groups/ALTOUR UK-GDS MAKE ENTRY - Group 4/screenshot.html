<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
