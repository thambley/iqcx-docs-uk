<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
