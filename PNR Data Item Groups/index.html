<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '162c118dbce58202e99c2753159ab624fb5d6656c009711e6b5d9514a07e869842e2463896b71043cb264294c8626a1533e983964ad387d8bb91c94b671e22f6HAgBx5S/dYmQmkvYaX0w1mELtXnM7IrTNpBT5r4jfirBWT0PUtLXcX3UXIg8joQ+4cYi88NmLYMiGS5L8gF7Nm5fbcrHUl/hLNBma7QzwRe25fQwY43hrURvq8AUEbADKs1+ZnvPE2uEKn/sQ/05aBj6T29fLd4vVfCFMBwPwHkYbtSQaY5fm0Yv0Mx50JKSyZn2u105dmZqonwRsKUi0R4NeTTSKgiXsClAXFKFxIOlzZSrICbMMRCNB00Vsc33ybkMT9qTxWLF3qUOJn8IDG6bPC66NZku+EfZzBaf4b84R2rhkG1q6Xawhk090jl6WtXYgstsl38gNEwJ2bXtudQgliD1n6JNGK1SHCJbBZvYQ88zGyBC2MhknuJGCsj+avCdlZr910UDPn6x+pYlQG09pS/kUCejWnn2uWE7fOLSDhklIfXWy+tjcd5gZuaWkaympjCRdV6wA/usBjgvKOByAxXFiSdBWNbaM+dkObhqi+mRh+gavQDnpLQ3KziWFVwtNyN58cDmoXr3B7CucoCO48j3AHBoFCU7pWmcuseJw1adhtFm0N5eAZAlb3o3z8LbSxWEv1nDZ/EYjoads2jsL8Ga4hXyHtsKq8QtIWJlEmDKHolEfKd/sXr8p6qb2as+AFpj8b2pND5dRXyPyBm/ToIkPfSxsJ+thKszlD0UziC61EcyMI3n/9H8saUivxHUAa4aCnI9Zx3tCuLKmm9R2szz6pQx/ZAnYdA46LgbHAphhPPBp9qlHsAU/mHd9o1oEpkJUvvtkHrsNZd5zgdx6G8zyZB5qKonmzy21aJm08bbPOj+yK3JpD298j6D0X9anmYJgnkXnrZmKRbJ3ODxYq7rNk7TrybaCXlcCO41U5A6Q7fOS9of5zna2h4x3Wu21YvQTun/K00uy69wK97CP4yaWA8aNOq2uhoVaaydLa9w9H6yDbx+wsYSGNKpoDYhl1O4/ZtZlCS1rrU3wef5gziKOKGtxKmp4CFdI+YYU3kjpYu4Kcr+0eQ7g+WcYOFtHan84/AR0bhjKtsWu8daVAxthNgA/A4WsdpY1pfGM/Pc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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
