<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '3a7df7403bbb7bcb53a707d60e55d62afde4088e2bfca6c1beaa7776d0a6a85ccfc82400c62accc9bcde94262eeb4e566e729a30968eec3396f0ba0bc331b0e2uTcKJkAN9P5csyZ+dYa9hkEUgF5U1JKG4re9wrhm2dt1qcOK5/6SLW3HKYoxPbVQCSAf5PyqZgOnt8nqA1wmRDXuaEM3Dbck227PdYacNvovsE1pIJsXohdbYQuuMKIhO2SNq99nebHZxQEEHEyfYICT9k3WO4fZQ0uh7bYJfaJVQ/JR81h5IOdobav9+f4S9XfTTePigrWQ2wJwxAK3iYqs3ZbspSqkIYl9AOcYFAWX+16imzGpDvA5XL+SMJQ0pRg9ROSKZDMnHzFwOAoKe5gE3zb8/9767Zg3DUxRpg2mLFx8DEPGY4SU8Xa0gfpSI1mOvxYeXt2sHE2eiLXVBmy5kkgxPYO5zBDiRRjiEIYZnjdrBLsRJpoTpxw/3g1BAgh1/yeFr1Bf45uRVjTANFhc728FndestOr6qe+M4VlDa1RuMOowXCJAmt2qRxvysIfndB5LnHrv3hWzpo0vHAwwdquODlE4uJfJumsjmbzsj6uWVnDBABSALgArTyYGeqUWu13Wag4x8ltLGivuLr6aaAivCEh8zhYBlQ71479TU5+9H0Yrf5Pax5OjK/1HEWSuvnx77IAa6xNawkx/eqXo6PF1hBfqqSNpRedeu/sfBf00iTefQ516TeZIipJholTTVStvldUWLOIlbK1+El7YG8lyXU9cKg66PGm54Fm9TjsU1XMwGkjoCbNiLGwoMM+u9qzYeg5KLkubOKFJ4sEz5NvwMs9eeoxbp3kpv1OgUd63zfsHA1ZKRbcL2SAPls6j/53OwZNm13znXZuTTb4cXYTEkI5+kfrdKXEzuCgsM3EzEEM9H6HPe+GHvksvkNmwcYvQXXgchN5UEvlalV7T3eTiD/FHIppB3tO6IrlRF451i7bHcqBGFiX24MFc72s6VWp+SJPB4lHd7pUJ/A4Ml629gjET47Pyxqdz8bhYQZ9QkglqaBNX4aLUjmQr/qZ0Ugv6gM3IDz+IB5BvOCi1XbEICVIbWOYeK1gnQ27Plz+3sDH1QK1ljDNLPUFPe0sKRcjguJ55dPmpzTEakbMYABDzbTnQZvvjHeU10oFXWUrYUMIw381ijFanYCxtD6mYvFzGUT8QALcfm6bR+irWtFN96QqIxxGQTW2MboMTrlNvvnNxY8GAszTzwJVETvlxuPzLqt43lFV85+8FWx6KmQIuTxjNt6V3va1txNiVKKBd85goHnDleztpFFh6nUNRqw5xBGFaf1Fhqi3qns3M7ql241dxYEha40Dy/+VaieYiWzoLAOTef5n/JJLrsq4PINp2ULiJTrnQLxXx9DhTkj5nKtxflBS304UUr88dh2M9kpzojEzIRest95tGvQrWGpRNX9Ulit+NzWucbhIk8uY8tjx24VL4QCQnjxZOJ6eyiv1GLb+RuHqmkh71VgPEjok7ohykz0RWRy0zzcGmSd4yK/SIgg4m0fYixydyZUxIgRErzlOwINwj0k93cEEKqVS/0UIsWPBwibDmlph1UnWEFoX6HCiy0/Qp1t6fibogE3HrJKMw2CmGLjAFjSciEN6NEivzUmFJwwT6EjnC20Ly3AJnvG3BBU9eBEftHDG7B3fMipzTTwFVYuOQIxeueUBa3w4qGnL20EKIv1yCJ6mRhkJpINRFNpfZIZqCxE3MMiGEPhtl/D/DbvsWKMXj3zdu9fMozdx8wEhNXU+TUVVg/LTjjveCK1nuQJHiZ/n1AyEUR/nKYSN2I005BNw4hb+EsG6K4186J41SmWCH5K4Av2E2lvCDdFe5wHishYofWwrh3EPqJl03ubCZ0HybYJ9oKDQ/0/LPUWnqtoehhrULb0zrkvIRHxteG9B5IP1H9FHG+T0FxlFoPVQweN9sPgvdZ5m39eiDwlKLqAqOyEpn9GnFseVr2/AHetwQE3clkATpwYQoyoM29Jd8vDU6L9pggEqVrvhCzxAIU/kFnFdl/4iNqu5dG16wsk/Qmgu0I5yroE2bw8uGH4YgX/G86DtYc2u6i8MJZMI14L5MfZYE5c3YsQ9PnJCup0L771s3En+4gnGGmm8+/eOyNOyfAIem+Q3o44t1DJ9pbDrEaU4V7upA1kUpopvYz8SL4AIoiZ29haetjLatOg+5axukgQZFl+L4gwdSVyuez0ez2/n2abxVYsn62ysqaNdw9mtPwtbddlc519UrwAMmK4v7QXai/zJgAL8dwFZLsgGgJl9rmHPVCpQIwhKIIVWCoestlTiuc4ymCiSBnCxRI1zSMwSUOmSjOjuc7pWkb8d5wn3G/+WMEuYy9XZp/OktWQOQWehwEUyNQNSX5cDsITR5Wwtd00R6BgLDHSPM6kIPEIAuF3goQUuuDIx3afc8d0/k49KYqfX2vqN5TAuRP7ccZcJWGWxFADiYtBJqPH5UiqFssmys1FAZaoxG0fVxMq+mfyFoA98XXTa1jRIGZbKWA4WvXee+X5Hm9AZDBgWrAW3AY2Ff6TcPV/jarrVRdeDGRvLreMyJh3Cji+gYzkl/nL9c+NwYH1ZGYpWHywJhRr3BUeNm90wqAXUGfoLbke16EdLZAPLfRlx7B3EiP/7/8cg9f3YmV4vTqAP4bDRsaoUFYhb7FV4DZ4u8w3cxnHjcPPdbNdBbZCxO5vSUR7xHREcaLn/eVClw0/ahQl/lhTQHHpPFcv2WV0cXRkauabRofp8FCYrLh4R/ytmU8WqGdSKeDobum/JKsFYshtpPmKTuVEsQoTwjDa6Mjw6YQ21D04h7fyoA/pARUrIBE0YifGtX6DUM87RqdOTXDrOdhZ4G2H4ZBXHrTrByq1J8ehvPrPi2oYAkZLwLupQXAZLBfaRKr1HPuRXX+T9Z+Vl68/577V2l40zEsH4GP3L2Bsr5udH4Q5nkKFSt+Lwj110eCLJANbixKwW5g62PsjHGqef34xyCC8BYqUxiNZvJIbY4k8xsVdXRWHYD/udIZ9Hvo8iTP491FM0vm5nBsXEscZ0vCcFEgUcUFVl6YRPZR//2799C+XyegwwqG6Ot1ygyheShS1F2GJmhW97qCHorDeACGnhu0UJ/TPm8w3XLd1lOcMRui7uyFUyCT+QIbyQ+W8EDbcyuJR6z3DSkQEzBWmb8jARmRFFZrUdC8Frh5nLyNJ0aNdMS/K48RfzA9I86y2DbI5RSfk4zyqUW3YbVhV3nrB7jaiEUNLK+EzIvx37JND78RQWCNQWo4VUrXQHKgiMuKSKBl5gJ5AwRdFYNcEh5BzvcOzvrDSnjxT7pkkAi/hv5RN3iOQQchdULGLLtNv4T6ROoz0Tq2QNhRLjkuEzYfuG33i0fuVpLeey28wuCXvMOy9TKu1pZ1ioGqCtMiQXCKhRnfQR6spDp6DJumMdirnprqc9AtSBlgd4sjptxgQXqvsjDJFhp7sHYixHVRH3pd+LQKgIE6FcXhrvZiZXUCD7TzfA7Ua9lLmk+CNURsaWUjKx6ot0RtfSBJLaVit6bc303mLzJ7IURwumcv0rc145xg9EjrOYT96QfA6xf8m9d+3IEMXdLwg9oZ3wPq+zPatgAaVNywip5fnW4itkrHQe3LLUByZdW7ZDnTabl46gSPzqBKolQifgJcpltrDiDX7cAH581RB1J3jBYChhIHWeJxLps7iB8h7SU7x6Cy8MJH/a8Es6fsIesBuXOX8LVgpvqEuD1dYac6MJwnEPpxPB3qtc57M+5vqr1fbiI2Cq+4nPBeKKuhPEpwI8rJ7AVJnipKrn2TXlteKe0HaGy2pIdkHPLWAGdgD8EILua8zfbtEhGh8Caa8qIcIMA81kw60h1TB8t/BjtlUb+ZB/9Mtnb/KAhZnPzGhu/mmwuwkXVq1d4yE0kg5Cd48R1akCNC21DF398ANBS4h7XGVVHTmga75XEhDkaEsesMGnmH1KVqSoP28Y6/S4Mw8IOFm7sCT4ihGsINLUIPHgCzd6tnCp6fxBmg/dLta8Lx+zrPodiupj+Vb/r5vSvXUDvm19mZOE3vggHBJ8douSFth7tj0Pc3DurG1cFkpXJQ3Va6zkK4fvvhYKpUi15+rUN7jlweklzX6LbUYl0VjUz2Hiz9pW3wHMaMOblNEE+SRd7KPDF6TmF3WEAXdHNDL50oSzEWtQ9BHEkNT8fhEuKFt8BgfmY+lpOIJhui64I7h7qME8zq+6hTEq1MeisDw7Nn9P0TXGjE9FNlP11knj6zcdCepXexvIRptNjbyo6hGZa150uXrfrg/VUdiacdMwK+ewsjjL+abMBdsph1itsPaarJM0hAwclbPHgcf/48XBREEO5qp5KYCLJLyalIaJwlGCpQapm8LwLX0d9XDHQHxqYz9p/SqWCtNNos4vMe8uaI3bLMS5BulEM7dFUYmPEPICA9DPLDAOb1XS1R8/uvOv86oBoQ7cd/giwNjyy1j/IOl/6CWT2IJ+59zNObPJ9AdmfL0xLxQ+L+27QD5OOvPMhENPmtjxhOaNWPX+3sa5HnhjEZNY/EC6Sd7m/Odx3xNi5d3q21v9iRv5L19N6CfMZDPedxGWbakOwodHqGpOmtdFOp+T2rd1AhIOMjk8JkjCACT29QFcLHquhpwwlTi6YVuWFXPTRhGq9z5q7v4K8Dnc1bRwZmLCO/qT0MzAdoNsBxOXROIvv8AxchDncotyDZrSuwgKuTTCnrPqT/hwAjkEr3hRdeQIcos9lCKOVI3HdTAvTW3wzLiEFw1EQzRD7NRi2n7hOLZPcrj7LdCcJMAB/g/gZqJGKhhA81m+BG1zr/XUtklzDfcizNIGGK2Bal5HeNK8zY67/XfTk/aJ1B2EjpLgTrsVKleKm1fThIIa3DhZnocQP+Chsob5FD3d3+5QKbM+H+5eqRckbCgqvRbOHnW8NiKtu6HzSgKWdBZwBxvgldCDAyDSmaw==',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
