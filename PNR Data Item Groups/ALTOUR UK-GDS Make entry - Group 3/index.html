<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
