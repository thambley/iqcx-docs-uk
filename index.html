<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
