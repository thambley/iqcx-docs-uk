<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
