<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
