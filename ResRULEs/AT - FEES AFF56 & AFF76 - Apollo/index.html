<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
