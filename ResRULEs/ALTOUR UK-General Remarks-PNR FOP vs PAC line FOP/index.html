<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
