<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '91a35c95259723de3ceddc9fe256fd420fdd125fccc50ee15b1d60a77b5e66896b24da75c98d2a4e380072d99ee5d85da5f743469f969748359558283d26f4c08I356iCXTyHYXxsOEN/eaCoWjTUve9tSE/DdBAz4XonizSCy2Hdvn0/avHt88XV9xX/MezYkVvC25hKuujiueWtCObt74Jd+av2DFS3rWPlL+9lbVnDUUzP/ydow+zcxGktj86D30UN5ufBwBJ+P8Ue3LZfoTsSCulYpNpQwtB4153KZe+z4QY49FSh+zidZZ9OYQXxYcixlVkRrtiAQDRPkbqUdp0BGrf2w//1mBdakNiVpetEJTGBTYMwN4Vz4XcwBcQfffET+jKpK6TfmdFpvtxzeGZJfuejn8ioSqV1GvlLsP+OpvMdlunU9yvBxfPcNClnhFxaxc3YD46fFGyl84rMBDyn9Pxgj9TPZVHPrSMqKfxLr+u9s8wyvb0sQ9OV6ATYGOSFdHWtPT8GBiXT1klL7fDB69HtD1cnDxh6YBFH00XM8156iviLBQbPHpAwz7XiO+fBgGl+l1HvYyq76+831dmyCL5eyfMcS2slDYySO7EhP8ZCXymHfTkPJFiDtDz7zSnoDwEpk43zT9A0jzpVEGDrWHh38w5NjKz5eYlqWi7gH+LbF8fjb7QXdLYjTXUen/eQ+XTsC82A3V/dddCVP1r9AbfHgLiAN7aFAx0JeIHHhU+nnKZLioLWNtfEkPZyXhFM/oszMqGoRplTQESiyYetPyqs56NEx+oLECutEIGyqn9SzVYcNbATaY+5r3lulht5H6X78DaJ13pT+YRSTDwrpzqCbsa1cL1UXfzgiLT8nZAw+tK8wgWp0RcInIqAjbhBqFfv8bM7YY2ZrkQt3oKWTvnwS+ndvFu7Fr5fp1QdGV9AUMGLanOpaiFKa8lLFMepB4f8IrDVwd6IpdqHqBNV0c0aeTXe4Lhwp/D6Tc6wH6e9oqKJvZD0PYPO0Xh34EAI51nQagfplIdgdXOOwh/PPahhcJ2iFbK1jEg9l4mZVD/X0Nce/kBVp3ZlP2uvTIAQMdXd+vFTIBJ0yJH6ClTnQkaCa8DpKnh6g80DJFIpRgvJAlhRx87okemMwbrCiRVczS4vBNUhORqxTKk1wLhuouj1hgXV0BORESdyh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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
