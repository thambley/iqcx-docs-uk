<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
