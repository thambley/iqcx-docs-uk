<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
