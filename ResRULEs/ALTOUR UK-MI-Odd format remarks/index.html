<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
