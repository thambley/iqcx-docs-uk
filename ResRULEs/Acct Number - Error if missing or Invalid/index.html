<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
