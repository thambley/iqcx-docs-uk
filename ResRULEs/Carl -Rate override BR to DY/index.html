<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
