<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
