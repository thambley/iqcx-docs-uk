<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
