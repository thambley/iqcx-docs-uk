<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
