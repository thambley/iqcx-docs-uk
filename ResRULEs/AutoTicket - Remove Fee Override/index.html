<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
