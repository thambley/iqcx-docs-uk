<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '000993c7053f94de988c8ee898e6473c8d11f285003ee86825673e10c3e9973db1ac8bd0aff15c44a4ffca7ca7ac427451d3f52e684220905cfcc818c3a462f2KBa50FjxesT9gvNgqwlrxPV+HrfAUTsLsggzOwG+FFKjh2dI29HIWDJyYDdlxIcjh9jy3YABWAPfXsviF5XfEfryt3XHFCBA7XxC7eOtCHz3WSNqymPOhXx6rCVqHoXHtqrdorhgEox5CA8sk44pUaNjo0gO68gq1jzZdvPTN2lRj/tegJ46Ihd9pfnANffQpo9e8Zm4a3TMqJdomaucCDXbYj2YN/O/VZvltaDup43LIn5V9rhfKyOGTjdSeNPAehei7eCmimUUjudEstVA7kx+qtBQBo6/JPuHDKwqkCOupkq0ZxYncn2VqtPjZsp896hnI4r/ih7shHjGIk0mwu1PcWv3rCBb13YeKNX3IL/oAw5NpcnaM+aUWx7x+AL28ludxQt/ezQYQ5Ed3U7k3E0XW9i/vrW+Cr/RKVejc2YNSgqA9HuOvVnd9XOZKkf9/m7sxoQokqeLJO+lzJy5TmoCd+trgZpdoEAUcsvWcx0rA52USak+rwieny/p3I9HxOE0/49Bx7lwNUgLVSo7HuvFpB76rdJKyfK157NwD36pFE0gv0AmnUeneAZX3UYaztCCQcjMEE0RzGHgqbuVHz97QkpHan5JDOZLqDlHxyhQnVr9eW6oQorykAZZbgeyQPqxoTJYhUVeVaVXESEdVf3WgVxgJ6RFc63GEetHQPuc1QjD93okjlMxzieJVATHX4h1axblwxsG8wQqsPwPHStLGM+Mr70+sSQws8TrOTSl+QMhnjiwmd5ueVn0+HUfIHEeLhzofRucca6gqhsh4Qf2hWQn6QS7Z7fWOZLxmKXGT7KSZ57kW0jD07BX0dRBui61+2JrYUVvxN3d2zJ8AJocOXyQhE+btgc0c5pS+am5HUXvBHgIahr2ca5mlZuck99MZl3z8rv5d9ZTU3rSR0JEtXX7XiiufuYB4Rte42FK7uO3tuX3LhFxymzEvnU9ertUL4VVYT6ouFfCDZBd6BPsj+mqQU7wK5IwG0ZLh5/ekFEyQJXJ1umpk8PbMAAb2NII701hy5+DkLI6UPhufPoJVrWmoiS5KhlwkvHimVevW5ai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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
