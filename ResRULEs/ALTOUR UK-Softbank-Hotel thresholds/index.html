<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
