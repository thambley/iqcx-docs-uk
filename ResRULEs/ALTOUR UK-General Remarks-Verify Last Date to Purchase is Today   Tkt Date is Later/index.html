<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
