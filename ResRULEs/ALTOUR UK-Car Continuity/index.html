<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
