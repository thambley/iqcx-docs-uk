<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
