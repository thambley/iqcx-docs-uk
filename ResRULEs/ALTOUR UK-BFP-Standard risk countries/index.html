<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
