<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
