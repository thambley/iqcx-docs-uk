<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
