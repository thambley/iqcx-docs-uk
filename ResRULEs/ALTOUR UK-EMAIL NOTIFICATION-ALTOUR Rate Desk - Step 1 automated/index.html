<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
