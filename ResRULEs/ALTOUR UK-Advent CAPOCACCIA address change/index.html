<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
