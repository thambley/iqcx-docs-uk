<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '644b6a69344ec566a2ee20364a752c25590b0df6e7e3d40b07f936d8b7a0514094a575c8d2b9de506363b6984ba3b194970a83a860fc9582477ea9403da6d39dRwNEUbnIw6srhMFRT2AkHuJEYXmfbrMCxywlnZbMGO1Z0IS/IwygOZWG6mkOqhObVHromD+iINYnzruPp7dCAbKARM7wMdB391xlweeR5wlkPXPG1HxyaSezW/O4Lt6t1hsk7TkTObZGNpbgIvgkZdfzGTUdmLKg4A3GZYRXLWOQq7DCqYcxSPgtjej8GvON8gLjyUnCOEXCsEHjZohEh03MK8nQUAW+GUocrC/D8luoh6c/FgRGXl94gI2bzb4lKhRJOT6QUzrXzxqLr024W7xzeLTyndwdCbeokOZKTphg+8oAsXzgeg3LDjGg+Hdrjv4aD0a24nMmFKNXc6lXu1cHL+VoooucezcvROXxLDwcPhS+LD6vQNkf/4qpGg/AS1D4JHzE7jq8CFxAtJ0X6Hw0TO0Vftz3nrj7a9LzKdxpBRV3zEa5V13EaasUlRtWEUBJhFlRxn01rTCrb/GSLph8bui+of9uVttDAEiNL88/qWXh4Al+Va2NbtquGeHYnq0yVi/dDUcLkBcJ3Hh/ZmYkOqw5c4ySRZDD+Jn4VHZ/FA6AGJdZmNW8jlpY1R6IVyL2QnlfD2uxWTuWXSZKbwx5ywOqA1kr80gGB/bpTzxnkKhG+jS/if3+xmNbvDn6DyHflnrEkYzVa0xq2XKw/MAJjAM5i5UNxMtYyLuQiZJYsrvXlPW29nb1zEm0GGhLL1eectMW5K+1WGH20oOmWjpP35e4wYb+dWV9AJeSS/4rD8jiuekK4tPVGLni0bqto/GmXLgL9oshEZcQeQ6LNfrIIGElTuauntosb7RTJvUHwk3F7yZE1f7lLN89pCxW3vIiAk+9kPBdkOCLLAVGcLddLSpYlYsDfYC0NScOraWDI4XtM22/KY43+qkkvzKC6WWvy264hD5ZkqCd188Cz/nmOs1+VqW15ed2FzMc0MPSIomnVt+3oontEWfLaixyDKcRisflJ70AKZSRlLaU2RhYdJ4o6NEVYEGYaQrGVWnB6vQcJhr/WJVytnu7YIyJE6t0H8DahXMRzDUy4zcsBgTPBMUwQqjV6/xqnUnqBHWrMlbXPm3DluufpKgKvAy7WDr+YfHDwuY/NGO2s0K93U6NDfChzg8UgXZges80kmagrmH9PKPnlB8KBieXwMYCroB3tRp+JaCM8mvtcpyTj3RC8njKIvinPEb/ow9sVuCzFOoYGyOhFNpxG5Y7g2ON6/G77E7nAoRo47zo+sOMWFpl5kyhkLlEq2Ck2nzzwNtjbjjC1Ut14D2gh3BuKhoQcS7pbHEA9NdHd+Plq8cGSwPL1r1RYlj7+sno3rTZwh1oj6e8rJHVqWSNyEUsxEjNOMdXexmo7BnwXJ2FNE3C4azLdwYlqq0kZ3goEN446fya/MNd8pIqVMW4Jek59OYEr2orTOx/sewuaL0aZMHHpu1Q7PqaFUAZY7+34EOSYBun77IUsekY/+05/xOUBDUiCP9R4c6dv9tt30NGaPAAJqQZPbqNXMGAzavXzvQK699BgMKwdVm/8oLTvn2xHNPym75DXRhQ0cqF59e9/BMVgMtVi11jRp0mobKLshl9ZukJSvyIdzHbOaxixq/uqxarcz6uTvTRayAdxuIVMXGDCyi5rWR0zeULqplf5N7UsIPCp+LYkr5/ogS1yLuYOl86wljMNR9YXAnl3b71OZC5eN2hZ75KgBQ5AUCE+LhkLlMJ1vackAbySUL5q/hGdnVd/v5HpCXbjVVDWvdykbpQcvI/GbikiCWdHxUkaXlkLcn7LjgEXi/LDy4ga32Aiw0oj7pxzQxYYlBARNEDf45fsGDfgaQ6GGJ2G2Ni6H6oK6BVfs+wHGtAE+8O0AUNu10kCHWr9hEUZ/ISEuV3bj5sLVlPOStwLzPa5+ECJVvubidScAfIbMAFCq9bybcFPpZEIXNIVf+TuQ6ZQXRenOfQcGU7VebESA4omDV92wjXDOyhSrzy3AXJC5gtAqBA1b1vf1yVWGMDds4z59ZTPxVHn0qUV6jXVSh2L5LwawtSYxFXU6Fe4rIxStICEfZnKFc3c3rQTej+yG2eWsRzDhoLTB1Y35D94zccrGlI4QaYmf+A/mcWfn6+SiKrNjUbJlYNV37nE32oUZdX+3VMUb6I/ndbA2bRTvmgEJ2UJwSa1AHHDsAsGDuWZYFV71WojYSXhhAQrCUyHHxxxFvFV+t7xgho+9BBbLFoWBz/Dw2nZfsQWkc2TnicKowFU6PAW7ROxj6n5gn6azp4whtIv4vBTf1xEIDNvA0LDkKFNvjX2kTwV9tYTSrkQIz3FFbavDTI7HmtpjB2tg0lxX3mpe3nkWDMDAdD2Urgp8EA6tdQznNTfwQ3pFL5b5b8Rh4ESANWIzfmPsH2LqJXU9P79/MxZ0SKUExXgCjG4s1BWsXN9N8GIcuHvNgPTfDtb6KG7Jb4oemxSXAnC56M/r31j5rsdYZI24wQ8tuEN5inkKg35QYc4usX+eEi/1qDfrW/L5S4Qujquu9e0tl0U1EQkxwKIJ2WRhB8mjt59s8IZLiZ5y60fz1/CcXKKHi8g7Y0UWyFEFhgqGzBVEmAfagxFxetasBTk+qd80OkDQv5DDxfZQNGnCV559TQi1S+bUp0+iyGuLB/k9SRX/o+lqEaOjZO+1zqY4VyjuutxT5+qNhn/c1DiQJBHxZASjJfatl859cXV1VZfNZS5yIf94pN3+bMMtdVpEcY5pR3+M7kXXmlDVHM6GElIq4qe0ZuxfSQ+m21BFvsWKx4cLPS4wnSXC68xbUGmclFsxvBdIXdF4og3QOa8oyPbmmyfVcnj9dIVzZdY1hdhpEq8YLc3dnRjX//COOuiCgnev64LO7U6pvng+3g/9Xv8gq56SEBTGd0l3UTGRoX++U4DMXN15gQFEZJfv/5CAWKFwiFx6PPgGrmdPK0d58qzjBsjCciFvYrlXxESwh343vcXIhzkXU2Q+K4o1lMh9UOYCiWHqys/dHd7M+3VVAa9iP4vEm7GQzYU/aLVKvTIjJuXEfpKcHtbeELNjpS/HI5mmxruwzCBTZ9gT1LwdMQaY3rGJ1PBEMtNl1Rd6TVo1s5ozEzfggWf+GXH8FPc5WHZG+ZVw1Z+gcEcV3RvM/RowLn4GtIFhOcM6EJ0TqF2zjEoeuVovfgaf2TFcoGiNovy9jdK9EPMRBR5XEru+wQKEqal4IzLu+CAur7F2FcNhBxvHjO/Ue7pP0V6jkH8GP//TDvoHsQApyme4aBnboFmP01sN+QfUAbfd2WpigiR0n8H0/o4FYCqLyOCVxIhRJXolj1GFoPvqqBbZik9xTiFOeE+Y0kMbx9Cx/cEAvGv+8yJeQcJSzZPDvsY216fGeS1lA6hcZNIhQEoxwlhYY/V5bj6Vkp8q+OhyPKKkjqsesBHqOw4OkGm9+xmsiumaiGagQcV441xNTamd5uNm3kFhf8OTmrNZjW12aPOcdAtJjCXyFPD7/or0intHk/pZ0zDx3E35YHavoz73+JHmaoIhMq1rkxVKFLVgi5iyLXOx60cRFnrgPDil5d3/xdg/4JFHBxTqNtE+YO0VdjvYdsuWxVHpbtlkz85o2F1vXAvC/Fp9xOjnuyYlmLfi+OBsw3hChNHKcM6OEyTeC/AJ6S3ayS29TszTR4Z6gCL6E0cSzoyTxXkvNnh4dyEP6a9eiXHFa+vzAKNbph0xg=',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
