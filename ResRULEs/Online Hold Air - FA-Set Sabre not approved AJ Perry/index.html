<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
