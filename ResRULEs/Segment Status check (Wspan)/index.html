<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
