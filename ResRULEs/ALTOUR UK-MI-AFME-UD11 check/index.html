<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
