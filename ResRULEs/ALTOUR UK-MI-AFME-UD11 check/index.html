<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
