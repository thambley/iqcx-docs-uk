<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
