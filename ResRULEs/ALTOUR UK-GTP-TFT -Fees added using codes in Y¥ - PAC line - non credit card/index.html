<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
