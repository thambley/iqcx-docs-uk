<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
