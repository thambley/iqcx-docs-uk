<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'de0a7129bf0d15c21299c0df7f2152f2d3ac3f2330fdd2614c811e45000570c7ae4443543a82af9563d67922312b828c5abbb7ee5b9117e84628c80a65c0bfb1WP9u/3zl8wMpsxr9FGyoAMlibtSHT9EnZl00yckt08mzB4YdFgNhZDyTjXda6o08bA1zHpMkUKxJegzYAzdrtyHlP9ip8DM216rYsnjAKxWNkU1rYxMI4EiqmNfiMqMkWWUohAgRtIkNd7kOIN76taOpSNcNsEoZEYLLPW2LgCxOkSfeIZo2REVX8GT9bZRdu9h42P0a4TUV/a/Ld7j2SoQJuYpGefca60RlipiK015MRnhbgibVN09NkJTIBI4UtU/uXtYykwSsqALau5lraH+ViRu8cmNRuy0776L3W1kieu9ufj93l2Jo24MseL62meNiLaoUPK15uiWNOVR/RE7bqjVpzrHymiYdpDKLVGcNJqDADy2fBwMAu1tU+jofp396fSsUHtki1KiUXFl/McqlgXRPvQHcushikjtXD307L9AcN24KS67KzbDj7wSlptRNMSwweULNeeekdLyg1cvBKlYlmd2KHOVGYK0/f++TNj6+iGyksIP+hnaCIsWpKbMOVwz7vfnl36NkTbqccp6TdjuxVsUeym8DdRaq+BpCsiWu74+TZ8fLjA/tjmAxqELO3nxyVzABo75DBYG8vnFL0ty0xXp2aFdCWrVe4h0794dRUeDay/6mVqDx5eIJ6SI2vuh0n8TSozyKw+mFIlhvnQunKcN1IsdpscnGnH/txJG8EzAvN75Wh/yaTSvqqiCt9E3Jij/4yGDxSDgfzHqZN2dVIJNrm4lK6chMct2vQz2tYMe2tmz+xdsX26/+yDlrRynw+n9A3QqY1/Bz+D5JsL21Qe86RSGkLY+qqAkZS7lswRBUUUmsbLZoqKe15WbYIL0VEURvqK+4tmGqNlap9EhY0gJ1oXuHoqPsygYZ9m04UOad84eHRgdQ7jdEINRE4qDAQM+tvtlNqCcKZTKog27NJjgb3D838nDWaT9MMa/Q6FF1A14GTZpIwq9YCSwhcr9l8fVC5WE4u00PRWMdi3YcArk8bBIvJ5mReqshmaWRAiK8oYoOGVLQt/XNJIzz8LXaKPBs1Mq9f3svthPZ+4M4rowZc1jkwal2W0PSW5Pa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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
