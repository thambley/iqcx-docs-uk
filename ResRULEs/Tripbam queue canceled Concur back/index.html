<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
