<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
