<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '57df41ddaf3669bad9577dc523d7d0490c2acce1aa6e1cace99aed036e14df29c7414dc62dcd307d2de7e9ac91356a256496e174a1037c753ad2c9fac902de51WsSGsINzYcdTHlNIrpVAAEWYXHFFpwjeLlfqYKWIVQMMdNC+LAA6nS4jvy8BMPkPAtBhzp4gBT6OP8N0R25jD8h62faI8PoF63fmZWooURFL36HL3t7vTkrfwGK4DF7pL804Faa0bQe3yTuaj/4usyysUXnRLHMPZHUR+W/etLbb3lif4Pd2hmGt+ObHkqhxYP5Rn6BB9ehdSLFveqNycjV4KZnVc3lzp8Re3R9byun4O7TUCc/R/2raxhGYvfAFG9W6ixk9FOiIfwomTaWVSV8n9PPgyU4LtIyJhIViPIv4dv3oRr9IeLhyTkcJU66Ze0FU+8TG71WvaFKxblomzRioeYNf7a9HB6uXLnEbY4vRV3Xt1qcbk40PEQ4DRbqUqO8dDXimFBc4RbRRinVzeAHKYMkLGCT0DiCIJ6WSUhsdakF7lfXew4LzxilYkUmheJ2rgbEOyjWA2u1T8gGIUIg8j29AOPBrahVhppazkQk4l4SxEyWQCi/9oBJ3JM/wp37GPAMXLurrUlMxjd/pzZu7kXfclL2udjWbap67sfF5lQ4vq0Q7AR5Lq63UC3gkhwhPHgtBiBLNWsOnkvrQjLA85gMs9JzkEZCYq++aarStojJ59me0E/I0w8dFmF5BjQzrWRhz0kWhPBJBkhGerdMiikjrisQ0epaVniyg3ijsJPuQALvnB+TnppgI4/j5zwAEqjFaR3KsMJ7ct2y+hrhbG3sZpSmhRrEbBevk3BMxSQo+O2tgDYJPhpYE2vVM7FW1VfCcfnCDG1P+Fh0Axx6kfjrg4wyRTk/88Jnd86tGfUDX+kK0qMK4tOfhHActN5iSgCY72b+5L07/BO9p/lmTv0WlIhgrcvct/l5NZ1U68aTs1Pvi+GRunSBu+iilREE2EyIuJuFAQefkHmAOKMp+Q8nzR8I61hjMRHfmFykMrvI5HPHsi0KwiZkfOrxk39Tz2I657vNrZdCll3n74gw4HS+Rt42HS7dWHD4fp2okAYZeN8r9Me8mnIDx49i4gBDsPtbFVETyVUotG2G9/Nut2TSroH06WdvVdWAJsMMTwHrk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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
