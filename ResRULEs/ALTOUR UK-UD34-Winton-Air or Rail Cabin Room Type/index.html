<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'faf1dc1f1b0bec125ce3674c3d609edb1dd0d2b3c941690f82fa47a422576f32c84b1daace6a5825a6cb926f5c36e1773166a4c5495fc02f34b4f2055b9e3627mh8f0efdzF1dUybw6ltePXZDiuw5urtg1itEcsaRqnHZNzvU38N5zaWfGSVDh9hCPrR8mhzxC+Zuz02r4czxM5GElN95u3/Apu8q7svHUZQFumJZQgqtkv/9FQBI8oJ8cRpLbp4H66AD3ka4bomgxRCXQFwZwVy6L/DdNtzML+kln4R/XAuvvB9eaNENce5hGiC+P7p/UajdTvbSne2ncAfGxK/JB/CCG/wFFaoW9hn3O0ovr2giWdxd4kF/7VomTM//VOD0kzX7SAOUMK5raPcI6BL3SUnJflrRTxZuItMz3fpEPOVt2+zu+/apLEK3XjtQLlVETxkcekR6cvUzC7NZegY4Po6UDtsxoYx4A2896Tta+PRbJZyr2ottEDploZ7ufxZIlWif8w63hkMWYJ3zz8jqjBC6RSgqUrk2BVNUUD/jq76nSounKbGTzx2EtyjmTSEiI6Y4KLk51IKUcmS66ZhUMvYYD8PwxPSieRqWTd4ooM50N6laNscygXHQmun0Rk21GnFRfzOP9vvPAW+reoiGflqnPBs0arTE7+AkSd3yq2KYvEh5cVeF44NGLfNghMa7Inlj4cPnzwv/dpyduYj300FOzx7Lm14bAsZ/xQFN5WgLQj9hkUmbnn4cJ6m1s8V73AreP9JWinIVli/KpUr7VnVnG4+ilFWTReoUTH/V3emzljt3vGJnJkQZsibLv1L0FBhRPPJD1uxgxrq4WiCYA+StHw7dMpVL/coJSTpxmiM4qR7v7Y4FGQWEkZFkp8hV33/2wx2vDcgCmIdtyjfbFtI1cB6Nb5+pAuRDyCt7woCve/w3RpuMIUYsE3HbCpJX4wHRMfeLfSQnQMMArLi7Le2R279ICYE/sPeMswJUG/Y8k+ZR8iC6a21i1PXVV1uReWlAVO6Ufj3ijYid2kz5DQefudkfyggDm2R6UY+FgUKudefsokF1xecaFvCnAD0B006etgSEbcRXES9Toj1OorJifwv/D497xEpvCqWI00MJRKHi6S4Rl+ApxwSA49Wv6DmUi743a71SEr4lQYKRsLgiaV5hWZAx+u1qq5gR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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
