<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
