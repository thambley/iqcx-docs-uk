<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
