<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
