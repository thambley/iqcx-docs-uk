<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
