<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
