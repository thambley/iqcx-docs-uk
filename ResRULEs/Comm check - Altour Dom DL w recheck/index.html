<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
