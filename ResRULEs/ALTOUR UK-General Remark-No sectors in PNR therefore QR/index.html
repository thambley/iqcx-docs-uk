<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
