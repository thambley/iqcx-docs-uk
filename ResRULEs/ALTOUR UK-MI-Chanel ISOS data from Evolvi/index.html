<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'febd40b51abcd6cc13e6b9d2cbedd672408e8a5e26d7bb22d8bf77ee6a40bc5bc5932e34666775bbbb1ecf46d43698129104f8fbc8dc735b4e20798a8fabd10abpGdCb7d4UWc04HwIQB7RR5flrmSQV7bMhvOVYO9uL6eYLkPCSwvD1NMnlyDjzGh8uP5eM5Fc4MufJD7mzaCvYm+lUkUNFcKLR5hDakyIHowiySXb8sRItpACUVPehPUzCZe7xoKOMKzW4tNlSoJwx2J81rinzH431xQkkzz7NArRUB37YzYcwhYPUvGfhvJJ51+HnKHXcUtXRHQKUYK+xo0oD8dEof9rWMI2VP0rRUCBiHgdmBykcUflq3gw4drbBypYRgDJU7n5BG6k7xDKRXXHWw93XuLJITugyvKSY7lqfYs1nrTTut9KLQupzv8qChk3oepmbG1QWe9KpC9+kl2UtmboweA1SmInbDY//U5I1U3HMfueZEd7xSm5/9597511E4IF4TZqS6B87baU2Dcd4NISxdryE6BLBIWoCCNyqoX2NFYX3Knh5DRqlelmWwcy90+jk2YpsiROlC1jUPtbbKHSG5dL1WcrTywZvYSa8jMxg3cFljpV9MdIC4kjj9gczJQdjv5BnaC0BbTu5zJiCw1A0efPWNgaSK3YnLCMwxm9P250JeeI3IRX6yHtMH77I1a6F3EccbjYHpEgJahEN3RfuhJbtsHydMgRwzSyThce96hUqMgiCh+4nrfdjXx8CzYz56AHHiIrQ3K9FaXCt23lYCTWmSRSg5fsleBiSiDNbI9z3MG6nb+vCv2zRPKpi/fqfJjhWLbJlfofDsUDzfM7WTb5zxGSayVOeLwDh1MEKfQ976cr43xu73IR3ogD5m3NId6OGkMWakbo1hVFvlyZlUce1U/Ig8Qf5mr6R4ie8O07fY/px7jV56sRvPeIviOOZ5mwCLKeLCNSvOoN+eUWPrYQ+q+H1+njmy0CwdmRP/YXli+yQ9CA7mhJLB7M2oJ4rRcbmCj/KnfrD/O3a9q+DcU93EHBVJafJVfk4pXJJG0ZzEwwoG69euBf/YRX2degJsk27XG5hkUfXID0GJApqqL/QYz5PSDruXBDlpudFIpX3iva6RN6F3FmJ7mi0mOMOQ1vzVTBQmpwwOKAL/ojfnJEPmbdDpmdglPBXry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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
