<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
