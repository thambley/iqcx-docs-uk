<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
