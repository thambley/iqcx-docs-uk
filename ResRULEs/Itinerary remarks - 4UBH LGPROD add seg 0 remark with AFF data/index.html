<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
