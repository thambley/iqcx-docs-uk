<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
