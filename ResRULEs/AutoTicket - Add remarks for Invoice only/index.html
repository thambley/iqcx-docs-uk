<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
