<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
