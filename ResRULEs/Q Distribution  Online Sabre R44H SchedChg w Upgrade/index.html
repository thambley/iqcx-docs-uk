<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
