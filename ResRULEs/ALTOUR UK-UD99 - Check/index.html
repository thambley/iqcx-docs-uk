<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
