<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
