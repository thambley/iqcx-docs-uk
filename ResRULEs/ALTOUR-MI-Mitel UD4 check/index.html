<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
