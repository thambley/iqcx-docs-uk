<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
