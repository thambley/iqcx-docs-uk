<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
