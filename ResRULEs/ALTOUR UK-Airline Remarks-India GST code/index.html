<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
