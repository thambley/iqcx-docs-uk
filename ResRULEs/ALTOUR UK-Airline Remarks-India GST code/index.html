<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
