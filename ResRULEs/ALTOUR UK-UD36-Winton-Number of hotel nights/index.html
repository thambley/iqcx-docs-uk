<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '61dcfc0a0f1684b43a563cb53f910b885b24f68cc2329b1f50f82597ef09cd88a6a9dac169594ae75bd30efe4d7f93533cab9400485721a9c721f845a5bca64blBbmujvv7sXjIkl6kPHXq0VoJmlhVwgRihDKbVCD7SutrJiU6SJycHL433jaftXwR5sil3TYqV3EWf2n4fajYPe5b08+jO8xPGFsUJSgovVZnhna3kQEe5DXJrH/WkEq7Twxl6ciAx3gM6pxZW0E4BBPc/pMjzOVX5rB4eRl46tVb3MBYP/f/WoM76o5YalKXE3VnTUCqkwQjL/s4qpQqQyyfyS/906baf1Ew5cXwHM4mLkmr4RnxFILnAvlVjcXMsDRtwgLnsSLAI8NAsHUlrpYTmG1oOPWy5ov/wyopKSeqRzOWTlGKfTsaeE3RNk3vPmTo0Y+nYZWMpZujgkI98MjIpFr7KAZ8gUJM+6hp2aTZwgoHnlqEgfapvh6YNClSlQnZedw7ivNn12XHrHzNmU4M4BWO99lMt/vo8qeWseZixOtjsUawGN/t20s0jc/CeMBLbKloakNUNbHR+CXdOiw/+UMdrNVeyy+dmD9aimK+MwiHubxD1szHggUb/t33e55bAve46DpY8slX3gmvugn2rDv5tKS93S1hwHxjF/SNlDSeISTSAFU5qt/aw5phFggn8c9VzOhhRs55zzp6sZYAG3rKe9Y8vDNzRwS+meIZyhkBFXLnjbOAPHDbYXzqGnGzCzJeXy9gW8OwikiYESIzmOo3w8JRw7j3xb2cBqppeu2YeSsRYwAsY5BiDY4u3+4XRvSipK8xtYSPsg2Li8ig6iXL6WxtJOlztRswD6o+x9dN7j6pdeLWm/NrRkcNita3D/2uVd0dxb/o74yFmDoMYWrGH3/UVtP72Qo3NagpB8GlX9T4RkeG5gaW1u+CDkZlj3O12zTb5/fAK4GNSLYVEMGlokefy4UbQXYLdxrN6/wqc0S66TLWk6CnILEKEjeXxHE5nXg5hzyjQ0mdGA7tCH4i+jINMRVyw1My8pJcrGe+wo2UxZlZTM0CLHuZ058Gjo6m9IVxesDXpI6SJr4Cz2IR/W4+Jk3OeVURu61WCZQU58WD1DDY3ex4RrCpWxdo23Y4iWhawgD4L3lcpwhbW8W1YDs9gTX/2Si3/MAs+xG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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
