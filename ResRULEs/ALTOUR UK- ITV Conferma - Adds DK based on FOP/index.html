<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
