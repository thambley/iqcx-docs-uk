<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
