<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
