<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
