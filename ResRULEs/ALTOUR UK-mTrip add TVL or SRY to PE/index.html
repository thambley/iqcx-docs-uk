<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
