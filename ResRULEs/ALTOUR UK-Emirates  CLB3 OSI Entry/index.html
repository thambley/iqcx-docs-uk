<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'f707d315f81da0ee0b77f59a1199c1a50f98e00fc9d9163e4117f3316c4e5578463e5a8262f495c5303452f29e2f0d78a02cb636494ce7d09b3d89e0cf51bcc7c4zUU8oIC1gGmFaIpNf3ASYmiIZXCVRgN8WEJ+HoGK4U5TJfe4VnrQPpi9c1SmJmimarwbso/OS37FYM4WFb0IlxHp+h0Ninl+2L4dFDkzDmVAjtlM1IL/dJPQlvNiE82G1l9rIpR+hYmXdFkyJhB1hCKd8X7Bp2WC/RxCOUikir2mug1ZGTPsZAfGFym7eYWKpOWNExlOxvUq/FAXpP1HWPQM2rZS6Q+4Sxqmlx7oJxuN1PXnTh7KKHjauoien9x655lvogHj3HWbclnzVwYfYxFCdyW0nYH2V/mZjuIVEgKwZDLVHCeBe9XvKkA4mt8Qm7ufyjxGS+nR5ThOLY8Z1NYQgWTEaf7hCmgeyiT4dXvgxt1grN9SEDB5UNHbuKQgeuaV05ZhB3YngPyPFF3wZFCLv3PpcnflEYrVhBDtllO+799aCygVOAV/0MbaefNhCeaV0YI/kUV5giFsaKfNPYNYoB3VEosFa5Dk9pftiLe33j0dDiErkqBaJqwJ6iGprl5uDXKXJ4ADMhcNU9SXYeTIXAeyeLcUW3N9SvXSnDzwPDGquq3xdTbfxHPIgMhS7o4QXZwaGJk90lPmJJGR05fafpEYVGefGuJRDmnuNQielof7BfFX5tDyq/d4k8BIJCILgvZ0ANthrXHjXFOi19Jsi2fW7PMMnc55MJ3A9MGSXHprz2RA5yDU8lrMBQfLOMRX7bFV3vvnl5a8+rLpqA37IBz5rgs8OSWUZEpM/O434poN9NglRTFWYaXzoGiCT3qyOwni1i0lLWar2gupFfnSdeiSMcmMOwdBoG9x29Diz4FAwZ0ZloIrPPtbFRMM1W0I6cVxDhqauzqOREMFrMOeQGl/bsaT3suoPq+WIvZAVfgGK/o5R+c+OSQTfREj1f/6l/sD1coHPJq2qFtVgAase1eTRcNfi2Ebj96XjqMw0esnwX7LmDQ/CRTxJ8xUAGHyrGEbaXuc59eoaLmrJgilNOtTKOsjpDO85Kc8DXLuO3D5QpA2EmOOABY0YW0HyVy0/5r9Gmm0UhmtqdD7vZfIVSK/rKKX4XDwNKWE+LdgRS9PUZsCJQVqP521UJMr4igSVnH1jl+u0vgnwpvfkUzdONpgM1AT2XirQqHx3oTu/9dxIqHdPwjAeecWCHAIBDMorHy3SP0laJ+RXPCH1lIDIFAsB0xCT1J1i5fE7Mjs9HMULQyNtHWuSPC0tZss+vqoPoareZLmz1Qvvhp/zsubWf1H1w0brhSsI8ZFVuVTgJjBY3b67gE7MfjQVbV2o4sT5PzZhgeis177LOUsqkjgq9V50mtKB9tNer2iDByLKGIlW27Dw8/kH7HJus3oh25InWrjdzJ05GVeSG3741/IPpys1jIaYsXcMOUsiwVmC0mGbdzVVqA6mT0b61/4J8zzyqglLBSreDYaZbW4QJ6+G9+JGjIGoW/a23VtEoZvYrCEt5YOrUXigYqyj91VxK3Z4nY+cEPguYWQZRgBpuJZ6nxr0IOXXtsftiI8URPKg6exDF8g4X22KKlhunRqvmuUUoJGgy9ddSlDdZd6owS63JTL3QwP+wa+djR9kp/uNYRDQovBkdND83rziYEmHVrOnLl4HtLORshygwIj5/10GgEbQHWfy1aGnu7FhUakMQCj9oKmPKMcj89bGqOQAzlh5Jvr/oakDFCzCJsVoV5DYT0zBDq6e2ykfFr8msrsnPQBTBbs041eFYqlAO2/LfLfMLgHbSjJfhkVvFtXXXYtWTtFDbXHzecA7x7IuQU40DbxtFo3gcK9sd+EeeveqGVlO/AnxGEgXftdkNSH+lnnd3xi9kqzsuzWNstRvTbFU/KT8puSsjGFmDDb+wXtUQtOziU9KDrpJLybqD5lgxA/eATpvhedJzuH40tvfdeuG/XwBiA2dKQ1XpWaK7HTVVe0IOPBclKDSukZGEEVZPAqPYfOCszqPpR9bEomvikkIGzofKMkyLSbiIqMLh8W5uNdNhR8VQ53Chq3I1QlHOJJ3K4jL6r8bbdu0UxlsdG7Y6lQ0zkHJY5ysri6GyoLsUzG4d48WYiIfmV+PtIdzRNLy8EhvNqTkrAKvpZrjRqJUkZUrCzCczSEOERwOqQBzNnaQKh330oH/FCJgluhfb+c6wp9apqLXW/gfssPLbvvte9/Rqa0vw2iKIc3DohX/b3QANS4EAUIE2WfhKHBcyzc9/MygMH2GtQ0fkccHDodzpX09IlBPddpFt+nY/cf34T8wBqz3klxWE0PyKwDzhpfOF1CQ3bEt24QMPWWQbT6IJDJPt51QgyBO8cV0lFAKQqd24pAmAeiykueWbuEICrWnlscQMesyjnpcozw2JUguhOPEcNojOqisc3eLrLD+zsnfJZJkFf2HoAPHR0YKdmolSsTxjiVihHCaMp2Q0tWzpOz956HO9dPZXwzKWeK1H6Qm+aiO01xvqRJpCdlzhffO1eBPpz270S+nvYkdOHue0j978kmpZSnO6ebttHr9VWgOO/kMDciRMDwkEF9ja9d92kFckMUYv6CjUG5cQIFUP4RsTEDdtNWYfWN2pAwPlBLWmy+4N7hELKAtk7daoldyaX40MW8Y5Lmeuolori9U8E0p1r/rzl/euNqYRB9ePgrlDXFm4NoHPsoP2ViqVr/5zwdDSP/BmQELOZXcG8K8nWrf/S7CpZoMpC3ZxGegeTiFdTMLHQpJyAisIbLNCz05s9kU9ocajn5XTq8ecZrQ7N/KEQDn9z62BbR5lwuPVHWG5Cq9daP8HTYNEYXi3RUtPJ+4mIhov1OPLTmFG0i0GE9I84CfLoiNdFiGP+9VOnkKlWrs37O475ZwusYoQ8cXduKrpT9flqG8oTUgEiubq5rvv1nXgF5hmgatI4L7HC4hEGWIon08Ei5BSi3uf/3SsBqIYrZTCAejGaHj1vybPbPzG+NGnX/TJQVxZxXtguCVJfr+1OErr6Mb55oyuitfXQatylfodAqZd2kdFUYuprEOqKP9JCpDjZkBeivVyNKjEW5wRzJsMJrlJSd0y29AKYt9yqme3xSHOgZI24QqCwcYHnu/SySNwrFaMA+pp0z7ow7EuYA0i1sfjbVJswezjBClGpKPIr7UESaY6PpPVuO86NWyDCNwuT22R49nSyQsk7jPrAEdDoD454fv/HHGnBskEPPH3UEiR1Y7kt+njTfIjg2OwBvFYPWDUnaWxVPPpXsuKDtQO9kuuqR3WhPUoSLJveUQpZsEWVmE6pP7DmeeztuhUakGRVwMbcW5hXeLEDRplEqe53FpNRyuaf07NB5BeyW+yOLyO76DT/l7wRUTHHjCsTuqwGfo1sArGlb0z6EWtiH0ptK0SYLMFTe3ZhEGN88I6oO1BlfzoW2KkksZk+XIo5sHk4QmdO77q6xX12aV3KQk856wEoaCozFTpLnSQtr0xMZfC2hrF9pNSgDeMqFECwmggCJrL0TEa1M1kNYf0bou2qfrFwAThR6XWYg5CEgpyK8pIpjf+AUCysUtFyPCsmqerkcQ42KYKchLys883ktACfudm5w4k/qhLfbPu6b/xEgnj6QrR4fbScP2bdtSDTwIWuQbQ',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
