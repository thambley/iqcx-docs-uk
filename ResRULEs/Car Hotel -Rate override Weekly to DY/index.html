<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '55389f3c01b199164da99456d43fd9acec236e738449e8eb33c663ad89c1991639f292f3ccb0f29abfd58f6745e6d5134d7ac743694f036752edc20acbd0fd7dBSVLrVjPXraKkq4/N4u6DRAvPQmPvefF3MdEHN+Z9I/3TSceVYGF1HgBmjYKE574i2ifYGRKurXjfJTKbzzgUNfl2tQ/c9rSnx8AsB3EXKUdmpc0an/ABrqmbDSBQjgFnh6jsB3ONBU5hJP7DBk8z5bI2t1n8V7zmXwJXvTbTKgVHki8sCwZtl7OoZqDHx00fWfTd3blomsuTJVNeGXjPr5LSgyfhhBNFo3XnA9D/z4iUVj4EpGYiTHEgHD1REr3ej8TRd1DXLmyjEQ1Db+CC22eAuPlcSXt4qoL0i7M11WAOuJBUrOZsbXBhrRDI3ukbcq9VWshnbiAOuSo8M9h3jRWcnTOM2owTKMC4ytDdL9k4smtBpPXiSwukhSkTNs7Qz1oSLKd8/qaT5kPj/pTBvevtjzvm2njepvz63XraRqZWbkk6I2b8U2xTvrxaKsyjdjC4avekIy7qZ1ypAIkeNp9EJyZ38EB7vXlPqq9U4SEcY9BOPPTjq/nLHjRgtfx7e9dwnHggw/CN6nPaUdkgbGUiDPVyY3/lDETBgBhYXtjau7qXGc7H30xQtOiNV3YrKwn58cBEPQ2OWUAKS4/LX36b8t9AOoqL98jQitmlMYzR+H7k3Kl2E0KfDlBiayg0jK6DotQSWxhwHbciDm7ZH5Uf4BCt6/4ObnelUqsMqxHU4I+4n3l262zMJGe3g84FSxoJune+MgEkdZEkNI4r1OTvtP58pJwzYGLAStPz1mde9AgKCqoqcYSetpI0Wp/ORB8URUXEwya+2PQlk2whFDs+xvi/M65ycE19FlUg3vqB2X3TMBNtCgwPMV4aATJeCH3PSJi++1OuTM64ZtIwYM3k0/9G/aLR5UL1dgDlyQizeAFDrL/cfMO1EANFM7airUj+vxNbv4IPEanp+rJPzAw1PHydjbu7ySIzkLZsER+RdbHO33N+PSv+Kbgdk554w9ez14quPgFsvJflXHDz7QPFyrtl0b+ckekq6xDyzTixnl90nwMsL7GGs20uasbGf+icV177TP/FwNjXltWhcTbB+cDyzDL53ZqHkppM+lbn+gO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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
