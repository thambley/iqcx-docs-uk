<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
