<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'b9655314a99599fe7060a1d4b27781a2941588c6605379ee8c2804e3db4b506c2af193b6ba1699f1608f7f166dd9e645cbb304383be534ad317c7f65a450c305i0ammRfzFnwkn58vYuvLWE1wqejozAHX/WL1WbAoMd9e72XaPfYF4oi7hQBUIgVUkMkZmt71zEwdrOM4rNMPitqq9uALMdfFzrfthkZGg3M8je+VzbIy2aErJg0raHvtM+itCmk6YkF15KRf5NhLgeOn+qF4K6GSwAKgQ7PfgelVyMazvBLYsl2RFg9iqcXU7Ugyt/kJMSRrpftX8idncoOANlINFyQYbSug2laZizPNDXpRj8BfUX/HUgSZumJZ2oEaHM9DOiVuK115W43j9EBPlbjsEyHLq2+xfhkZXdl5lBte1uLFXi98m5UDFPVBvvEWEDhqiIq4jf+yYuiMtO1plkXpKchGiQu3qrDyaJ+Cq1egCR71l/jnsvuil2aR8bsbaEK49vdbiYv7rx47hqVCbaVBWQd/jxw2ELZQ6ClsvGn5TwYQjv34CVQhUOnxHKQBKUYzU459GkXzZlNmKKURM9atCRY0XmngMTMU2nf7CEL0LT3eP5WuhvhlE4Rrp4S8/yJK268H6KewhBTntBVx1CvsmRq+XyV/arqdOSrRdtBvmRe3mCslaTqdIzu8G5jJElvMkM4oWvPfTv9lX6A6PUQSi+3Iify/1ZAP1YVKhnL22POCioNuFC1EbUZarPs3cEUC+aW1XBdKA7sftgT5Qn5QRoaZj652l812LDAu6yF/G/l+rnTT3tlQRUlZChsjIIlVD3ZPt2VJypzfh9yjyosySNLkWKY0L+Sie6bdsYJjPGmOvsf+R5Y2vvKG4rmWq6o/NqngpC/nw/i5c1tDOXXwjUo929xvscdhJuSWgEOUZf9WHixv3z8OZbT557bgbiUHR9A4ktEfWMMrqHNQAb5wbA75Tsw7wizIUPRF4510A+Ytqm3Y8HajORstHifieXuKMc578hlie2uHexN8H4/+28biR04ujUG9ho8xgXe2pB1JeAQBnET0Ggv0HFw6FpRKaZLq/q/JU1HUoJsfgj5xbPkJw8xta22bGvPmvRJi8Fe4+V14LYelBTpHxcUwyiQFfoKl8efzaER2pVBitkAET2w3CyxE/rDK1R8hCpg+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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
