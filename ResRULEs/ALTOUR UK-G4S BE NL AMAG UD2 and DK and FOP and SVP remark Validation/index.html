<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
