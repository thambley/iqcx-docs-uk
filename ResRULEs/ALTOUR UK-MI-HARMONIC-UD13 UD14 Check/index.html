<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
