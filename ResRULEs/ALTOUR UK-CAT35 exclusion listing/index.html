<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'b983fa913854773c8bd90f9a2629404e1732a0fb141e708c21e92ab39992e3a55a64343db52598f89137db45b8e9a479b8d07c6959a4df1e49aa5d04924f53568+1bM+B1EwUFL13MblSN/HotJ3sTyjO2p9SwVrRyMGgd/rx5psvG4bqy6DKqqvXqA1bNGAiLICsr0jYXuYvWjWfam/jg60wrZGOZ+LiHCzL7XLJFLe5JHdvmbHQIkpfo2FgrI3dk7/CLXMDLUIlblKVuuG9M0eYUe0zkEG7FnJyIscO5VlNE2sDTOf4YzDezzO3TBL4ihZLrHxB5XXoqwNdT62xij6kKUQN524rG3Q7Iboek25uqIzbQ/MtXqCAmo3qjKqqq8g+rp2+BziGa+wc5N9txc4DMndAZkbZlqqG8AZ7czjIgbafVt9DzZ7jO1zQ3BfNJ3TEZB8WfIZVAlR7W2weyV9R0Uv1T7ucSLaNgnTeAEyVD0cclpItA2dP3nlFDnUoPRPzi8ys/7rupKEQ8fLNGLnBrbixktgYpThhnt2NfcKb1XDm8tKu0U497mUTidbc0t1ACKF7asCCoXV8ioVbgDHBwW4FbJq/pqTsDL3Y4JtdRH4aoj4OW17Id4HebObYLzBZLFec6kcnHX3KA14kqmAk4N0wcOmz25HmW+gqxd4KI30PXiFO6ihh2OBoEmKHx76nQ0+G+rLiGxJboblBcd1HsZj42L3JUQTyu0W2gF6o1G4LWCKOtcAR+96v4u0SmVoFoBB5qW8n8tihc4hnRMd46yWBmEzh8Gax04hs3fzYxcLOhsmnAvV2nb6WPC+Gbm3f/MNNXHvzGtu0CpPZ9y8cKoepMFIDdFAR3sCHZhfoSrxeCqlh7+IWdvYnessFyeBVcE+RvgXzuq4PxjeGae3N3dpm2peGQyoTpNSPVgXh8IODojs6DxbMoL8CiaW0rlUH9bAdMTRPJoIdrznngjJDzaFQhx3RRM0HBP2GqxHH1QRTmcoqtrNtZpC2piUn30Z7jVodsbSVtEWGPKkKoEcy8kSP7fDvVbEJiMprQVR9x99czTbZCnAHs02nFEuroo9Aiwu1eVRW1QghMg555hz49n7OjJtjE0o8QbtT2n7not+WH+EjexSohEJKqLH5c/s8O+MhDZp/w3dALtaL6bucV6U1wOJJjCxLtancB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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
