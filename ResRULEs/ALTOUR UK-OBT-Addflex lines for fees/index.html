<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
