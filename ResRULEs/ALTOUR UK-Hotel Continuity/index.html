<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
