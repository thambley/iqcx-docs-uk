<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
