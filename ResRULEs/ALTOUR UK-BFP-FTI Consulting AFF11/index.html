<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '0a9e8f461e1d587b925305502387281f38acc0d18c1e7c74ca20820dbb33dec22ef489f3c48ede522c8763db6c620e11ae311d3cba3f5c7c4eddba265bff189dqcpzIXHOBYWZzSyzLfAPOXfyrxJMD5B34h3qfc/EGeFR90tNMjGjMj4v5gurHS+1KpOpiabACVDnDeC14QDak4v6xhpD+IaHyqFZd0A9N1wuEyQNIr1sZX9i6nfTkPAjf25vw96/vua4W8ZhXOtB/I3Zz1GhdYaSmTfF7cTLhkLSf6SztErYy1ArFAjHuAildCVJlGL3I80Kcel5TNltcA4XxgxgNI4I+CxpPXK6a81Cb0zEb4CIbTy9eej+5jkMm0BXS++vnTLbAXwzW73PTlKgfkN8UdSv8tWZAk5fZ8Iq2vFQP2j6UBPgDB7UYG79bFqSwkLlkFac6bWkvoOk//in6GptQwr9DMrMlGlftOHgpujV9HbKvU+3C6oxPSRHPMaut4J/hDU6fufgt7bV4j60JHY1R2JFndJKOT5JX1UThymCwDjslfcNCwu52DMNm4Jb4XbjKENiesM7fhzZdHZidTBvMomfK5IJKrxdwYf1Rz7SqOFncZDZHpsanyeqhxLirIwOAJPDjB/Hhv1KhvKph5xWq8gLE4WpTY/hJTMeQNdoJFp7dvIi/bR8Qepkb0Q4qLyG46x5V5FQPV1dD2vsPZZ4mXN9DDM0yzm/FAsLvn1BQjw+tOF1kCgJKYbVIofpDO8nns1lUdfq7Noh3oxPoy2x+aiAiJWq35lp+pqIFapQT1ILggDioiMB8nRbmKbLSDel1y23aK5xBfyxmKVdw41f7bbPIPWUV/Nuh7fODsxU9wuY6pbBuLeUOxitnhq3naPoUkKq/bSdQ8V7hcevTNq4YWSKheO9Vhu0rmcQ2n3QAzi7wBMCGgpd9tH3p05JCR9Jg2gA8QL5oVQt1wEZfxFBlqvykNePX00wrJ5tDnrQ7pvhy90CpdabjUumhveFrUapwaiY4ol//2eRaeONHd8lK4a6m874FEOychv1ttq1JJBhtCd7TAQQcUuYL5XM5llUjS+S6at9HYUd03x7N/1RTfQqewW3OyYJfKqlSni+Zr3jxRtmAuPIc/IJ78adv294P3yeoPh0annzLGD3NIq+eLqdsgY1eUcu6gjuWDAT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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
