<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
