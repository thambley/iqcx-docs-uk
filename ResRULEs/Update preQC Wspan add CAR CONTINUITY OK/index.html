<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
