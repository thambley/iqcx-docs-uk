<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
