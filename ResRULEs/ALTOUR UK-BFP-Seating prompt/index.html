<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
