<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'f2b3229b24075b48245d3dd515aa72d51d56c55739e52c8d97a5bec70d63b14f33b24a0b41f24a33382b9ce5be66dbfa4ebb5659c205f067a90f31fbcf93e31bgwVAs4XR7PZCs1mh3zBlkvq/WaQWm4T/g5ifvpellEGikd3Y5xF26027Qr2WWKSkIgWNYqFGVL2hKKT/5i9xOTfHzhHErMbramFG1QKl3mPoNfGZUqsOIbteIZyxmTdR/aMEO8d/dwYYJhGb8ouYf7XEll4qtL1qY/1Aockkz2Rn4Cc4bB726YuYawY/5RN+0QH+wVdKk/NPNGwHkbV42CO5xwUXtSLAn8Ct7/V0NalAkprUTNZoLaD00PnL9QNAl/1pCPmD52QsZVRoWzHjlWmmYGKz8PXgjdrrgT4V7ylIzXTmOHVqtpcR9PIdviDsfsPo387tHFDv1k5gegqEh4KooM3cH8AubdydfbW2dpDCIQySuGrcZE+3go2sOdgx/2qBT1lgD/8faFIBk9pjprLotOL9y3FDVPsV+C3+ne012NO5kJcsfb9JZwnHX2SQ8zW8qeGvzIOSc8OcczFQi3Imuq1QOo+vaQupztGptEGAwnEPVelOV07/MAkWLCzy9wQBlUZI+dHRjVn3V+xJfjBMGwgSNPEBqSpnici3cgAXL9sxuSss7zrbz7SulfWCZYanNURzgQ/y33IdtnQQi9tHwuLcaxBhZ3CwsHLa+nqx+w3T3pPD2tG5o282ISmRTSU9JLuYVazWsa6w4XF/sXOxff5FL5xgKZvjL4UODLc+9uk5y2kICsdrhbAiOXc5uMSDImPapwucTiZCyGOT17Ve6NcEugF3KVJwlGxTUcQmR/cetOVJr/pBN0noBQXNLeIN/W7yrFgJux0jJOaRq3bwsGjaPoQ8fTbf3p35kv46Hj4ePs/o3yr5Wh7t77qYZYxUUPdf3wsPQXIDyiCy5thqu6ml6PkWH0y1dHealpaTQps7GKCEtVsSKVIrFzEcqdggt1TwpS0bOdJfaV5I2T6x3R+7nQKT6x43QiPPhIhIln3tP7yTdlAPDXFmMNCcMJf9ADU8cjPB0D10o1CxT1C90EJhlQopYMjt03rKZk28U38mr2uSOh81YaMgCwzBUT7moopEu+dCzYOr4a+zfY0jtI9FP470vi+jposN1MJoxLu1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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
