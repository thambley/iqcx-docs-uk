<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
