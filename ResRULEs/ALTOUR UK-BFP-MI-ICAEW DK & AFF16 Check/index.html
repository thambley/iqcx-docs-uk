<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
