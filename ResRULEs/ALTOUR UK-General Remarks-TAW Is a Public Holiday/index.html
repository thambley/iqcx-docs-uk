<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
