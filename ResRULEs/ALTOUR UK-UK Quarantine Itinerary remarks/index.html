<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
