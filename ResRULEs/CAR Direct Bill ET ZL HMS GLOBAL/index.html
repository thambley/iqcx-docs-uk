<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '3755d4559d30c606f02693705a53ffcbfddbed99ea0524f41933168c8b66006fb821298254058185bd2cf202be9956a5628052724d7de76869d7a4d930ed49bec2Q752T0six76noeqbVSh5/zVgeFtXxPojGtoBOFv5Qutt1WSAMnuML43IKY80jJjvjj73FK8ueFCol4WlabiupJEedgMlLKQxG8OXDwdiCHqNg9ikY9n/JVx4d+RMRm5eaCQKpaxeMkLUBUcQ+fiI1rCuThxo0nsO9SenFwmi653EMwAr2HCvgTiQizr3NiQShObWpwpmroE3Xs1CIWgxgX0CzLt1LXvCmiVmZzUHtjr7Xt5tVaZCsmociyDiEovOtGV5vbrEoB2qKAkRR+CT62sEZT6QOgj5/1zg3BAMuA+9el76g9txL5gqt09j+MeVXA1u/9SnP9swAsX31gO5Stl/6xbb72QFAiFE9K04OrEor7zOoASIEujBBgt3n43AF7mX2nP3T6e5lWfXkpXjFugUgCTbtHskzpIWBbDPgPFmf5iyx0Rxc+j1FyjV0HzP0aQ+Z2JJI+3GsXED92XB2Yq1bxnaG0eTQguMKbq2VD+mbwyWJ/eULbE0AXNQYjMsMCSaXQiuEp1wcbFM36UY2BQaLdQwAwsELGNfB6qBO3l2f0z1k8MAhblLWaz9S9DgXiAQVqgZv6dmoFLmlZC0vT/JSY/42XgWHt+Ozkm2zndjR4Shtw0EJezYThStOczu/UmkqFGv3x70nyvj9Y3PHZ6pC/MRB+QNESX07VfM7+TEFv7hDja/nELqxSKawDN5v7Jlp/505g29snYaRIVTISfVW23riqR6BzzdmhimtMDmEUmlkIUsAkMwq/djM2gQHFfR4QZQ0cUVYimNquS3BdH1vtOO9UCFTK5r4Bvyl4A+1c0UbFYWz2YjJaxpIXisy4atk4460k5pCd7iOeps+1Snwo6ESJjTXVDcKp2ZZPLia3zha1z8nryrC+5jV9RFx+ofP9gioyMtpQ+uE5UitqyrdonKec0DJtuItQ9v0rgRyTqW1aGioZPzfrXu5ThIm51XA//axrbjttGGpp8ph5748GZ3Eq6gRt8r8Gfzpr2+NUudIyo4vOD45EZYWbYoJIZzgU1Ajwg8C/Rb8vTJ6soc0nVauUq1rVsND3PsZopScr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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
