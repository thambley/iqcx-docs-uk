<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
