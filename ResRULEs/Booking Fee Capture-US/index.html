<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
