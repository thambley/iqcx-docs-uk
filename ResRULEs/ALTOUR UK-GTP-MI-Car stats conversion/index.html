<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
