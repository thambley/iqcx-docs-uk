<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
