<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
