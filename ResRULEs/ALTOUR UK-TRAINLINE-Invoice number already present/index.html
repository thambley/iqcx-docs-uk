<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
