<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
