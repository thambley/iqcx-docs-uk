<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
