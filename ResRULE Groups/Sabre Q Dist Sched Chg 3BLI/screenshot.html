<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
