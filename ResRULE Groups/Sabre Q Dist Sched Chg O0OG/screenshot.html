<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'ca83a83ea51331fa14e558249804f7dc5bc322cd0593359e4378e4fd1f160c8490daee2831fdf9268ee0a61d63c60f2351aeff535514679e66278533ab6730bcDVNjBh+Zr++KKuZd2gr8Uf1+2z3D616to6J0mxlo/vlYfO8j8e9F0clLVfRxEUv05DkQlvv6Rv4LpjDexWRmiza2vMvmyJ7JhzpS+kGY+LH/rrY3g7vOZDDtFbO0oPsK4snnnBVmuEaNyxFkZ8C2m3ysMbCP1N8PUwt07PMEt9oEayJp4Olk5Oih6kGK8VOZbEkp274/QXCRTD+oVaLhFqIVLgzVsA67nvSVnnPnkqhdWSI7wxC6QQIecK81D3do/HRLwkfPHNehTaB6hfTPFB81XLqI1euPfntGSgRZnDc90p2wCPjL6ivPnavSO4teRduMHX4WPi1tKPYTrP/7ENRc6+x3CUTos0OeoLDSOMqF49f1fWSHIODrW5c+tig5M/BOEw+FWnCRlnGlmrrK5hnEHNN6KV4Zc8pvuIyY9J3fWNabvjZ5LEuXD0pAas8oXJIud0fJVrptWBa0aujJlAoZ0aHWTfZHREEybL8O6t0F3Mlj+ydXA2jlK2JI3IwBZD7b0qXoFYDGLhLelqB4h2LePxu+mGOAAa6LkDr3+VFNTFJtlqNcyZxIL0eg1ty56xns3Uk9KiF1bT/7i66AbOj2iLT6FfJNVuX1JmsDpnddH9kswMkuC1Te7HPfIshBSCqiaWrZesJoC8rC22uC29RqtFoUoXbfN40hqQHgU1yWK92bI8lVVpVYjQwhvkkrsx+vaP5KPowbpoHOwe+YXpG0Xlq2GzaNyjSdSEleIlwq7TTkOMLYPRdPFKrXPZ9YhEpKLDbld2APPZCvr0z32mPjkFAS4JKR3VHHckgF3/sKI5QM2FawHzLwAcHHcmjc+tk23iFqudkHls018GVkWKd9Oh87KPjQOtdTv40sAM1PdmnJ7P9XHox/6amsyfwx/tP4VrgocO5w3B6HPXovzP8tSKBEH7yFkudoDvCUYabp9DzgDOqXkl9XWynJgsgRmZAirmi+NPbhbQX3My4U6RIQzAv705pAjgYGyYoPOZUCQ1RJZVooA3t612Ms0BD9+Px213iNgn6kQX95nBDtIUrVgf4ZjoxP307ovkm2qk+/rkDZ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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
