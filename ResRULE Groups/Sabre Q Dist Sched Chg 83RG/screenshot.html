<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
