<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'ee4c3a6f46d414af6d4692803e576a5888758a314198d08ba2b434b1b6cce9a6b9a9e01c684363036551c89e9b996be0474f1a33bc90b71ac92b6a3368a98214HJR5fJ3OXNsNldZl5Qal00kg5yn7dGiq3FpsRsL7Fe59PD5RR/loHuSHIzPjjep6R17Ss6sFGrzU29K+0XzCUvrJnPNL/S+CxcgncDYhen2xfcbYkM22F00y4qf/0crr3CqO4q+VQqrPKpbvm9Uv0D0wfSQGttv0UOIq03B+fuf4eSdvvn85j5V7UhTeJRlFX16dZv0vv7o53aDL1JLyebcXd/BJK6abqDdueT+6VsBYlZNeRZoR2rfL5MWxyl4vaOlf2zGpmzskhYO6L3nSEHS9KWFB90WPYijJkJChmVW6P+ISvvy8peeODx7XP/FjNkkBdiDfBFmZBjHI0nxvbNgJwJL9GVDFTG3YWwOxAfRNnsD5V6zOp18b/6mcycVEzVtt+8FjSI+BkFe0qGz9Kvn6iKA351BnuBkFIB1fdtUsGGgYZy16uX+/dgZoRPPs/sgfCFzZN8pQ016gbkdHyyh3kejbdx8B6QQXskeNGIo7CCdZc8e6JEqSiB+fsV7DOPky7CntlNUKRzl0xy5xSOkvSlojE2o4N8JduVDObXujNjqREf9DvQidP/7gHyNL/xJl4me6QtOFlc2XF6rJ5PL1a1JDGqbw4VyvZcs0EG9wG0rVwaCUdELpXdLsBypGIeEARflbfk6omVCt0/eD50KJ+G1eBq3qnFEt+fr7puPqQyFlU27DlH/G7qsYh+mF0bWXM5R9PNMc+eKc0eR8mWPmuDcwev7wYwjLiqYtqUoho0Oe8v20/6/AgrnmdVky84F1wNQoqVSkjybuB48bxzGSTLQZ32ByT8wQzKkdgquKJyXZeKQL/qrO82ZCu9hzg6zQgNm2MMQOv2UItTL87OHdDB6mTlzxoK1TRbf54XjDsFlU+v2YTfndqhjfwwE2NOko9ygmokC4H1V6oMu0Dr4Usn8UcGuDryTnr5Xye6QLLkzcp2OALDTYfLkZr5lgje0WFTJBVP6PDQtO5yGMwc7FwWB7tlpF0IhzbtCF7zFN2J/OkML2tz8o+5hSFkLkp3w/MoSJgGDwkj23ZaQU02pVyAZj10Ytahv04zUd3kfhq4TsL/7sMJMXYDkOWujwSCOFtNEyzBjO6+nSJXJBkeREBOv60r07vdunZKDqBOa3C4kQfDM26biF3iKxdqG+6ECA84RFezBdygYnWX57HEhoWfVNdNDhCQDC1J5NJT53hSj2mtDyn8v6LkbBsTom8p7tNlW7KZFOwTRoHgucacHrHiX4VLDTsjeH9QhjNSwWJjwPFPHCjJCBMpqUs6c/JltXablIHmzGR42t9+zn6T8JE2C3acwau7Z6YRsVTj4H8Z7yfD+gR7Gbtk+4F45lF1lM7TL4GTf8NroU83JVf1ku51Vd1ymRBtt7kZhO6GhC33qPz3YWe3z/UxiSwD2j97X4fkbuz7A8LvsZe/onjz6U2fo7vyK0oVh1VbdktE/h1DRv+kNiCC4fCZcFIlm809mh1bK+/l234sqEaMAQY7EBtqGXErAVB68E4tQVFk1VABPsGp1TAL6nXqyVrP9HCqAW0nRsm4UQTCzy4SvwrgI+yFl90KLyFQJYg9tTy5syAMc4hr3Z5YvebsHw3L7sMF1OqISuBUJiKj+yxqGBf2eFXFQykOPtg3jPj7m6yxNMySbP6cseTzw+bKTTH+ju7UhyJ3PPQh0dvWq7tpkikiZpX1VYM/I8u9T8ypnQ45GgwoQGiHxYIML+Rutveo1C3U11BnBnMQU6yB0c0mC0T60+2um+34juJuuliuuBTiTsKA4BMAO6LTW8KIOKUgrzeIZ8uyTd6OkIHIR11iHo7CHSJ4P5zbdgwzaCr/F98uzeeIjhGfO087QWKL/EW7EQ+q2ZLdh8ilwzykM0UYFNp5oqXNUgTNllu2tdcQcz1KFVEPSbWJ4Nk/7/K+HJruZBlYGft81wpRJEBlKAcAl2Rg9T5ZcwmT4OvZ0usYS8u3Z8/8GvtVxK4RWBGkoiDRSA8WmwjAc3pMMOUz6fm7KS4XX1jIGp4DGwmyUO+uz0by/3avNXduBy9+khHfxvxKvZ3LWF9AWyEP/LB1XaxFwpBRpPezhz7+VT411kQdbM9uCwvwbOUUzzVN1Fg40ZjsIUBtDd5QdWQr+JJorUwctL4mEgRIKvtbjoGwPuE/C8jGIwfZnllbGusbzma0OEdRsrgqSrkJV7qUfxiBDOjWlQANyLss73TfEbb9sQHUNZlrI7KU8g53n04D0h8UbkhHehn7pGj3m75l+nVcjOPdlGOJiUEnI8Gl2Ry8H2YxE5IM6IVIqFyd1Xn5CV8sxZtMJGExXyqXaTCZPfkkqXM9XY35s8qaJjcwCjz0ddAP0r3wCdio0msbCw+JsW6fT4LgY/O3xsItrnCnhShwDdJwTWO+BNJJQQXQGYg6s/jMjkWysIlGM/JSpwOelSBs7T8ByF4vQk1brEEnT4YGXcjfTk9LztLZ267uHZKTNJbKGGJundDbSP+5nGoZS5qfGSZg/bspAvVislY3GSAbnujJu91QUWK6KKj6Ow+qld+Rb3jUqYG1h1BENMLZU3WxEw0lV+jjLs77KA46KLYR5bqoyUp5tqtqhkVUKuPshXX8Qc5rdphBqn5Ofcq7JNu5nmiPzZm/EuEZRdASIwMk0i2V86rr9DNPSeh+NG0z75GEP/zpS48s/uHZbvXn2lfp+oBtgJt69N1ySAw9vHXCQvO8abaur6p0PTLZa9oWWE3/XzBN7KPzQn1zaRuafJDFkiCAuGFmo1XlY1jn2R31evKmG9zusl9oT0IG3ARU2O0taZrw+Jdd2JLq4Da7SFO1VpyFqlPCkKUFqUs1xa9KgEdAJv30+XUZCSX0Aon+SVet/X53bJEKVO5o9C3oUnlCeJdu69t6ML4c+Y2gvO59pfRuew1Fr5Lz/KuN8vhC19ZNMvc8ABVJtPdQbrsA3HBkMrI1Ns0hDXONMCq4dEiTZDp9/x5w7ayYpUp5zEB9AIiy6c6CXV/LqteVEh71J+S1cN/pFrItTz4sccD0nlLlnqlX73tqFmc7Q7wlDmdmA28d9jST0g04AWNQzNkoSs7i02j55lEZlQPzZfdle7ikpp2nsloCPHLdlrvupjQhVN6EbIpmt0cj7qZJXgGyG9hpdMSBWd',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
