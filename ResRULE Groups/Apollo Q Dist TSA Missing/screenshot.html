<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
