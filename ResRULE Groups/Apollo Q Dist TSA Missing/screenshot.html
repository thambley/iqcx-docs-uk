<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
