<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = 'bd54c1f6da0e36c8d8f3c08b0b37e359ec0ed3671f9ab8937ede3649796e6416a62e7c032b1deb63570d11e46ccbfcb8cf78cf78bceff3b092cd50b99f69ac2aFEBuztK6kmdjeedka8N99yLOMAUYiMDLiPVc3jeg8A3Ln6oKSMK3uSyD2My0w/8I0HmerOXXiN4tLwtWdrUhdtWnxL5mHbQhrfehtPzBt9G2Uj26jkkE9mn+xDMOZ+jQV7mPpnu6hKpKOiqGxiXiANQkRulHgfhTXfHkEa9R3/PF8IpzhmL6yAbk03f5PaeK22fbCKsCFQe/yA1IOGfWkf6n+V3qRpiymf6eHdws/qJryOXzZ+t5Kg/oI8WBE1Zc0k3U9tsKWotP0w36co4cGW3sP1shreLrK0qr1L6NLmXVn8+3e3QPJuy3U96zOCDcJzxLLs6BjvIQGrDxXXuTdCR2EqgcF8rgUDg5pbMKrR9wt2DF3HH+QVJ8qoVV4ixiEXYSREBVBdObdHQ4eG6bnBddQf7c0Vynf0GB54SdnX9K/E6rctn/uxqOG8mCpqifAhS6J1VY2FteMp1yR7R8MqTuHkeF4uGBSGEi+U25ey2poD52HBmbwzSey6DL65OSWV4E8W75H4g4KDmvz6vYnkk+59LyXc15XXUEbHfRJTI/WE2uLjFD8Vi+BMECzS6l5cO36SsWaBo3KtEDMMf5HaeVYPrSXf6agkZ/AsEXa+GLdoj8gZXLBYv0Acb8uEvpT4dP7NGW6qxj4RiZoeQ373evtm/Iz/XkwH23OAEVbjAL0n1UZYjlZF5hwClHeg3Ddy4YKKoGfV9iRhPiYNA2QLHkDsDEmpzODnuYYvm6A811EpNDqKOY7xgY+OIF2+uESBcRIm55rBc1LNjS+GplirlcxkFXqlxNl1eb5rJxrebTdHSPCYpftOAUAmY8QYiWXCoeFiN2Ca3vuBq9CgTPMi7QrWyjUTQKIG4ir6XnaSr2oLL8g5B2OL3JN+HFWgactoxFalDftK8t0xZKyRvvivJnj6mVdG7SM2OYeC5XTBsEyNY5kjylwI5UgAnQczqk7woLV/+qHK+4APZyd0Tu0cvWqo7bgjAgr+3afBhGjHgzn5frNF0NNSy0u2AxOUTdRFuHMM0OF4v9UfVNKLyDbfhgZ2xG3s/hjolhm8JzeeNKL3S0jydi7iN6V0vs+RW8qh3e3eWx3h47/qyGK2wFa5xCLbpw4KlWczYzOT3dn4sT+n9c1LXtoQHNY/DGu1+XyTq/pQiMNRdVcuf6Vo2BjEnc4lF4x2gk6e82LuWgWl3EyEcmraKfxqxBvIaUhRqURVI59ECNb0GAf8HBjhAqqaLjictHO6bQQLKFqAmAJXZDr7AUDtLVCXUrKy7PbA/UlHphNn6pmwAKXpahUDYYtmfntuKKVX1L34SjTpdnb71o59+csTtH4GtF8KnhgrGwRhqrqFXI/ZNe+j1KibqlwvvJwQT8ql1mHWOAPZkc509N3qQBPj8fCwXvIvaOwdbis+UhPboN48am8y1tp+20b8oPqgXJlJVDGwgpPdZNYEJptE3xg9DbgIWeiWEk70+OU89nFHz53GnEo7OT2TS/lVhfezsqd3NMt6M3KVrvWiaMQYyavy04wxj7LeHrLXpmH9XFkjxbZGwT8F/KM+oD5Zbo0+L+dKl9RdtfTz14WCW//g41sXmestXAkbrdaDubdWIrTs1TcE9xmrTWTc/zU6z6xUkuVkahbaovkpgdg4NT1aKB5P8BPHKDEH+ws0JfVZNCAbuUbNHoaM5VEDL8yeMdyXO2em4T1cKJ98vHKG3TJ8ZxFVW/W7a/zklX8m/h8hpPdo36TzT07ho2WkFFbvTJbyv6rBQ6oMKOdTvIsJtBVaO1yEffcs6qf3f3Y0wmPlRm9NNiJSWGcCIZ4Pd4g9w2fK/WBauMie4TzfUqbHsu7HNg2Qe+evHZD1+6y3zHa31OZklTUGuksimxaRbePtyaJ4WdHX8AOYCISonhsgry4nLT4dOaDoPOFmvW4V8R/y7M1+yRrkd1bLlICob14AfONvQ1B3wjh3VLE5BrcCYnWI+eVjTjWRh4MmcwOPqWehuTDJ8xBWeYuzQwj/ywdt0E8sNRwNII8fd+lS7nix49tiKaOBk5gv/5+i47UZmhDEkSO2N4TmQYDVHN6Ww68PTZgFKsWgbaj+glScq7dT4JwP5WPU5VF1skUn5iK+zVGQAgWzpomLZaxzBq3jTGFSxUrWfJjsZEKVHW8yRAQTjHKAzPNEH8aqsaJJ/269SSl/J8noqFTuQVOCT1bW2u/uAf1Z+/xvirrvh5FpHdLinR3twUeznUbv2vAsHkIT0ZrjpUkpM9kdpwinaGfLLF8qc/5AxNRIlVvtalr6QxgDXnTd13ZblZZhklXGIoOGdwYZGsspUBKoVQ6t4hkWfpksDftXKfsVhNUWJAxo+cWBpL1BbasNan5c2+HOxMaV7hRzGFrBeyKo3LRup3MWG+7yZgfDWIr4Qkus98sfW81Ef0YuTS1uPeGVm3zE+k/eS5Klqj8tVtIBJXV+A/eq07kzq8/4GETy7DUM9ruPWHeSphrIKvNAxuE3b82KG9gG+s/+IZFwlgecLOEBQhXDBYivMjoYh+w2h/te0Ld6nFXEv+6qWUJLAOLdvQDUKVX6X2XsBRQ/GdA3VemWF9uoF6FItr3ueuvqTEhIAhHensWrRX8zZ7rIsrH3vTsA3L3Y/ylMYeYAKIw3FReHgpsT0WD65PHZpd/kahkb4DACXHp8ufmlTs7MKviJ1mgPw2DX1RD9GwuBj+RVU53BUvpj8AlI5uclEaA6IuAclUzLX2hOV82TP5LTg7HUoV/Yu8++b57Eb4iS4E41A50GDgAdO7g/ceHVjdsDJGX5f7aqoj1wrZhGUT+MFILGq0sSmBVA+svYnQMGitPtEx/1r9ZPqmx/H8iePzutkpOlJxvmPrhXauqD6qw6sptSzQFXfGtNGb1u7m3ucgZdSVVeXu+6irdk9lAybTMIsWG1XpPe5enjPUdVd6kuXQ68cfmeUWEMF35QQ9ivsYQIfb14sbwmWiFqm3mNuHD7Jpxc6bgRF/7EZH3fLdLmiAODvpY5+1OL7KAsBduxMMD0r7PtmnAOEZfzPJ0qyQUkGI/BybcZQaffMRBVHVOxHamz5YTEyPQc7AwBfmsjCUp5GwkUDs2K+Qm4eHpNUO4tT8s1xMOLQDErkmFQTp2tq7MSHMr6giTCILGQzcZXxzV+ogjhlkLpq6FGvyTkSFrvveHCjDU4hWYdVX4J78qU1wPDxrBPRP7MXoIHgTePLf4/lwX9yLY6UqxF0TiTdSrCgsHE4Eom9nj13E1m07JHxeg9IFsAclxzSwbG6iA+ps5Hnr1lugfr14qNHYYI+iWIhlvLjULCC90RLOesqYW/KEV1jJ6HzpE6wuJ3YtzMxI0/sN6hN+2e4ENcmWWRngJCL8f8h+ViRxPoJEEQKV+Uxtio3KrNr4CF2MlH65Pr0EJ0X/++kXAKO7R5eG+BcC03+pyndrhKVuCu9CwEfrXkouiZ2fXmASkp/PU+MToixfViipJedegIGYtJ2ImTGt/XP2Jg+Yk9Xp5LyNCchEhrY54Usv9IOu5cc/KTY4L16dqjWmsf6Q7Ii2MEORf5kETheeXmshtqClS6fd8qR6e2DBzwx5NlmoYliLjaQ1E7K4Z41ho8ufgVimOfUCzuFvI7kiLeihwkA81C9CgpW2VXqZygyUkzBZz1RuIhYBzChbHcqpnhcrzNVTg9dSnAGuE8th7TfsqRyJWn6BmOG14E7nLgpeBnbKruUBQ/mqe7LMLhnTwiDU7FmEn8V3GW4P8zVlEboau4y5cikDoWHGEVvwwaxPEMy0r7M2FscPvB/amihKyJ0REYwEa0uXBD8O/ZtcYzGMSuynNwUETq3E0Ej6onoWg4kfgU70hzS+j7gvzMRcdJgs89Iw/A/9XxHTQUL3xNaLzmWxNOxikhs3wfVkWoNTIHewnVT4tbzuewpRhwLjJw92HvHmtGZpPUa7VISJlEq3RRIQpPnDotPzAl7/prjmyLUin2SAcrpMcf8yVjqHw8Rph3JnIcAunjtpGMhqV8P3Uj6oquGjI1nlpXn/y/uR3+scChOHujwi3FAhfYegPdFy77CI90S2rITb1aIuVS19iTWOmcPHhkMTOhME3e69Is5QC0bUdLEPNN1yvqDyOUg6Nxc1Vxj5w3iOSQitRkn9qwrm353xD7+m/YoN1N9TWBZAEZFqDb5mzmOit5hty6PxKZC8oypm+EHkHlRI1GM5eCdxw89o38Pf3CIjxyNGTtGZ87w8aTHUZ3E1Uo43Mg79ZJ/w8s4Z017KipuZImDzANI0XzH0OGjlZh8re1dELn6jFDFCcz/2tMHw+R+kqD7Giej73RXvdqRckKSPFQpIGxy/jXPUYB3EKeonphcYIVifDR+xnmDMEaK5ctZCMw/i6p+VUI+ce7D7ddBTAlYnCe80pn9wicXLU5Uzy1NC4J7K8fwsrfvTafTppoh+pm5zIghICIKLWaWXPWkNfJaicMB4yW+K5zOvOllMuoRyG5Z8sZhrA8GeeHFQci5oxAvVurY/HbEcATNTmI9JpqgpjDtieEXF5aeQxR4CDE61fWy0ZrCoKvi7rjRssoGC9oGfiGYXO+98E3qQ9Y1JhnM5dYwsWA5boXN1NY0XeUKGlP4ngeC65c5FhjxC5nntt+OhPv8UFdCjS/1NZRGCzlan4c0RMk65eZtbQdEm/AiNjp3ppEU5HUD70Sr8YoL16XM5nn5kg5pYqOc6PAAa/0IFxqeUDXNafH/TN+Mv7dinLJTcwRiZfrUuo6OBJ1rtsaM1rpZ6MzPxmVHxgiDVw9FCazTl1nJWm30QD0Rq4RUOsoo291zIvBIS1fQoOfB8gQrvKtzIZXXLEXw2KKR/eKP+nguvkfszEM6btoIImhhEdOPiY5CGDTqB6NT5e9LupfxSHpz0f8YCQEYtIc4II2I5ocvGr9pi5IniZ5TJBWjazSNI8+DI4NcPeuwt7XNLq/X7/qGU5ovoj0y+hI0DgxZ3rgb5orydSRPdSUlFrH+26kKYesbDax7LgfbBE8yNg1b3PTWXTZjapmWcKpiW6nnhpgjWFUqsRCmloq4Aj7aYdukYItFsQq+jijhaVBCQcznhFFSWU/o39y7L76U4x3pLv+fOOsiLySxhQWcjUo3Cmd7PVGBnqepv47n5ucwWaWshnv73AQrTbQN533SbJsHSkVcFqbIwax4OevzZDvOMVNvkQMBOz249lGhHe/rH3IKQyWmVV/Lh7tRSs0y0yJJNrCt1AFGlRAeGMhXc1mCW3/t8flnnMibN0Vj/oLNsz6C2D3HJtLB9RwbRP/2TUImKQTjp8MLkS3yV0G7gh7o/mrK2HvmAjXW+S6eAgje4NnX245IPjwoAzCYrWHQ5PHryMHukKBW7IkFwCZQ1d8S8BKe/sCDc2qDTWjFm+KC40lbKeH17xXc4a32f3vaeZTzJrzzjvDAmavkjN1oMVJgiV0lkYPl8a5dhe3HNZXBW0baJtOhwLsaw/8ypyIaSAghNgDu6yc+4bFUpcMsF3++Y37HGB3+xYDTHfM7kAKFGSN0P9bfQQgARByuRTfCXnUsUW9WzJKe4aofdscADjm6QN3LJH7Qtc+rHtZbHtMgGiolcJMkjXwDurn79Nd2uvuJEQo8pNwDCT/r8PmZtjty0G6dZ6oivj5ZakyJrmmBXAu1KqaJ7Z88v5TUW+BGAIYECT3Im7/NzSPLYqAOoP/uGBXJt8a8kdX5MReKDdp2mjn30B2hn3I0Kq6TjxKT1oNaG3pUhHnGR7FFvCipUw0mFRYuzq4Nc9AwL9EP0EaC6otX/ZR/p4tyaH7pKWZ276L64rAPEkQcFu94Yf2cVlzK5Y7bY5Vc1nUqv08T+mRw/BmqJadPUR6fgGPnxtixpC0ThaOQCW3GS6kXKSv7L2kLEzXCIMNiTW1TVRCtfiaLcMslwMjs7NMoGJE3GNiOH/+6ZS2r3/xrfRPN/o7qZ20V0OUOEcm4/97fweqoqzAXe6qLUspo2QlDRG7zbt5qieykzf9V+/wjij8b9OpfA81qoirN7u3Gt82Hb5GKb8423R9Jw7S4i8vLR6seXcVllXKADAQk30AfCr2Ww5o421r736059bReo2adQTMnr3odgPEZwSVCUQ/3JoJ9z2I/DMw5gPyohsg3THbCU3PRD+RMr2pw+FXklDWHEfGbp1bJACvytnZOchGuZT3ujCt1tN+uc8qq2GbU5cXRYx/7xVdspC17iaQ/GxGpMIdSiPvcgINLPGWAm5fz4TxppWaDgsdrSc61rmirIV0muhILpq/CnI0GHDhUF+vEUbTTrRyNqc9b0GnW5WtBq0xTD+U/fJnE4eI609P6oCLzPnT6+NQHnRGyjY/kG',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
