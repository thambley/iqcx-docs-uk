<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '1567d362b8a08b9d4ad53d836a26b47e27a33351e3c7d6917934aa0efce3ba9d903113305f8052679d4a44886b454ba99827bd7460df969967a144c937e35f9c/HdtOUQGoV8XfXaEufHccwTtu9EcXJ+gMLBFA9EUrA9sjo0mZAGhe49FQ9lCbhle9mhVyHw5ffuoYThoDBXRIz6Ms+5mMCKu/CCJjLVo3ugNnvkc0LmcLHIXYlZRz0tuOOOSgQB/UNgRIkx+rXlJF4HLw+/KVKfYHlhPWONNc7gWaoVfarBBiay0Zj5wjXJ5Vw868ObijSbo8UrkS7f7C52UfrjFoU5zVNQjOJcYkv8YT8nKZGi2xlFKZiZw1+RZLh0AX/n6NpZ3EaWoqZZ1Dtdz76DWgu5nx7iQ4kuuE361sEP4AvHgkTh0FnPQ11Dg1AzW0ZE+vN7s50OCp7L9Zf8gS4REHlRTV6KQOcQbw1M0i0trz1oEtDEyzn9vHEepum4UWJCMpqRs5+I9gVRtNKo1gIyRXyDcqc/hMjg355gILmGpIuiH2y2ufMFplRNQbaFyD3vNkVgxaVSQuImMk5to/X3FMpJMRuJJchaVTqis2bO1GfPMwpFSFZ9l8Q27ls0a4p64o5ZvqAYDasn/4HKaA4/y8an33XrkMH7gnf5RNEU4XZuGLZ8ys/s8vTmF2e3qVMJKPgkmCxFKJ2p9wFO6Z6kXnMfBPFqENElDJ272A6qKoHjmIxSxeMfzz0m9+4fTqo0nCVWJHP2sP+VA8EJ+vl8IzV2aZf9unR3SI/h+77PO/HuLI20Jv3eSFwL1KF15/7UAj7rVgUe3NOQJ3FEPDW0yHvaoXjnxA4KQtq7jKhvlrZT5bxpPTs6QWeLHyODQczt1yMz0oMUTJDlK2LzjDGjt8bJsW9esiulS9hZjsGe9bG/Kl5xSWvGjsSSRwXXoPaWO+PnifPEDj+dRo0hvpnqXtHA3p2UZNobKithvQbmwRNqTvj8ZqyV5lmFSfcKsH47h85RGdH/Q2FwmlQp6eTBhsPXduUD6At7R3xtrQxXq2SumXZUdLu30Nh1WAX506mbm7E5Jd0oAHdivhfsoS7Hmpek7KqHcIEYLCtV5//k+QSNYSBQ0eGSVNhLZRTpf7Methh/ZwsOQ2xnJq776fu5n1Q3+0c/uLXIHA6RwIukZTPa+V4J+FgCkg6nMjPzFMeIGq0/xg0YqfvZmhSeOuoTv9cML9+hLjzDZ31HgfhcZcgXeYQeQk21VNJAMYq6HqG9rUyUe+/qmvqjKm+FoyG9uzljlVVyUEfkS/+qNvGm7bW8zaLSqoiMTKM34B8aD7m4WkLLunjMfuXjql705Zul1L8WBdHGa72hQpTMvVdyZe1vpok4KKGf8RkpHbaZKmlGbkYl9NpU8ZfYBU23IQvN/8dr5SK3V+buAT6eDBtiX4hh4iqvAKrKX9+s2lli8fX+sf7Vi7w8bXqjA/Whyqst4/FIKZDB7TSsyHRvKWyybGdF7McBcYAZuz7+pgIS8bVqeYuy5zqE3tp9s3YzwmSK0ToO0mACIa7RIG9ioDW9NGWHGJLb6SLwBtOzFU8lLl/wBtlq6MFAaOfZV/cIPYssTvO0UeGzjCJt/7OnTks4eieY9bdchWKEuq0GuntD9eZAFKSZtWCr4niE+LNG56Oj3/h4sN+dlvbEWlCYOOhXRX8lv/oOkg92q+C+qtBWbG26nBbwLZVo8yheEmqZElD47bBM1VHSiKqxR0huqIrrJQFTN96rod7BpiU4H7BMJ1AzZFCdjXeAjvqmZWkwirqlLhbg9HMFApbTzdp6/lPp6aBrOqnj+TpZGgIdeN4COJd9jSGCIcOrLPQCEZXIcn5h2LGNjD7DRnh2cyAgdMPtzNDfLBYSB7UgY4JQfTDElzCjAt6/hSk3s2kGO/uSs3YVlcLzmaV24hPQgv/c7t5QQG2uJg/rz4SYuANWyISd7AUZEkpexiK4/Jy9EiZ4KJNIfxLh7lz7sCxfdWCh5gd9UHDpQZSbrs8WrbLpktcU15EpB3PjoD29Nk5Cdo8h+z7gs5QmlUu8YxXNTTgVGVsktFLYiDpsN77y3vChzchb7aPjWI7G045mvcEkxK/DL7M/cOQxNHoRU9PNT0+xvlEriraZ0Aq9S63QX3YhEfLNSFkKKfXJsBMIAprtjOdoEpJg3nAIws9VdhOZvw7Bato1DoYwNqRtJAbf4Qr+YYEvGUXQFT60yc4AI3zVu2FOVGCoEGUb4nZQCgNQY5U99uexIAN/EXenTbiaX048Jg47i+LBj9X1sqq22Dotw3Vowuc3djJxxggvXbRfUkt7uyF8NkGExbt+r6V5oclrIgLTT47lI4Qxdsnl/TC4gR+ARtgiC9QJ/FEQbcL7krCy2W+ULC3TyQVnquRx7MVmFL2NSUXyfQMj7rmPAsw542OSOjcIjtiT6PESNWyEi8CwYD/5L1QBAlmdVZFtnaknl0U9fgHX9NF4GfvUYvftQ6wCb6afiT0fG/UPWgxpnwNuOQAAdSzjgFQ1wPpApArrd5OpplHyJSK0JVcYu/QdNl8m5Qam24nqiFqA/sduk8lheshVdX+WgMaFamoXoI3b4FqE19C5/Y28fqrcam54epzpJ+hjnd8UP+TTdpQINb/MLau9FhP9bjK3IeE+4tLj0uoVV8mP1oH+u8iQlmCEQTVgwCRvil0jXxr3OH3H3bE0xud394W//zdxEFH2ZYxU9/Kb+AyxEufpXOm+iwumM2Gf+vwcuxPT9EAObmqsQ/mM7pLfiRYGLjNUQdiIaa4qahQulMrLpzy2zd7IR/eGs6ZDBdNNpZvwu2nOVbFqGNlAM1YVO53XGx6oRlDel6oTA2BlqOeP6TSJepOa+oEmlHnuSUkOb72MZtweWUujMJfUflic0MUc+9f9Udv8T2dV155fMQjUeeeKUCBwLvxL8RZeXxOjw/pvucX2djTlz/AqFjZWE9/QpLHeSijoLR+IXEj7DJLJ/thYMMJnZEhTQDMNVgmNhMVWvqYEy91VrKMAn3dgiLSciweBaGkfdD3KjUVS0EaQlVEWXxTQRN1kQrx1dZLU401cLXF+uHYgMHorUuQgx/Bw6bph6vIPy+cm//Lm3lCIP59eEMB06TseBEioL+P/RaIDBFoc4FlyxaJS6EhYz0Te21Tz16w6gT/N4mpdvdlIm1GhGkhlU8aBeOBd7ntdbMgrrotW5bD/GtNs9tTozdLzYRK5iUxAhQrSLrx4JdzC3xYL+cdKqRbJr3Q6Cmrw2o5SzLKw9OA/ePPF9OS/dSzNGK97SZR5cVd0U9TUpJjnx6G8klwj1qQ9GwUVFeUZQhqyM16smqdtla2xrEy7muyBpBL6GtI4sXHMRKIWZ7N9i1UkMrSqbWnSx9ukI/5RcDGssycMjLbkYMNcD9O0ViABocr7th4v2mTpPNpxjv3Xw2sMKF2oQErYaPuecTXbn8zu20/ikQKhWzowdrBAwa7T6PcLeUUlrNRgXVQUtCaPSynoxkrAxuVw6Jv4NeBsDElDagIxfje+DjxK735aDVBHg4YLJmEWS1USIY3K2REhqKnOyncPVCx005PF0skqrQ4aaBv6fSRKk1J4QPWVnK7q5inDGMpMVXgUYCNFyrxUN9tFf3PFCegXiNOsBsgVGc3twgGeOmVXfuT+bGfC/52Toh4NbKi7uKLQr8pltCzlheEqJx9bABNKr0VAS5Tfu/WJAhyru7TQaYstmdBda9SxM35I+NEvj2v8nJPQblmvAButrYIzt6r6czfqNar+OrdvX13cJ1+CPZX/LtYBFIUw+5/D/5aWRV0CIRzWQKCvRJdktfMFxAh1rOxaCsZTFGMmHgDKQUyeFAippqh+3AWZhRWZVIM09yLRY4kQ1inNvBdEW04ekb4vSNohMMrE4t+MCs2DBKyJ7pKt8Zu/HGo4URB7pigIWWVLZqiU2JlvX6mMgfIEP1++99BIe2wJPVKpT1YXiCh/uEI9bf7CYGckNVoM4qQj6ZR24ic2cKKhy2y3zjyMKdAht5fwfdnQ8I5h8SJuzPpaKgFZDl7BFptic8n1RC8Ivq30XKXmTvqY0CuzvscNnSuLywoS/ETUBSNqXomkXUNjSslirPc1Eyn8Y+JgJ2vt/8UKWOTzkS/gLwbR8dvAztLw0yKnmdfxNRMvuYMPflF93xe3iIpfgjOerMLeAk2dw65rFq6mk1Maj5exHujSHCvXwjH08ik7aaYcGyoFs08L2mF1FOrOg1UzqdvAK0ps7zNGFOvsyYLQXbd2qXR2gOwfkEH1sUDi0Ni+4LJadcx7fRKn+LtnEOIL/lxWpbaC1NTQ2Kip1rRYTMA87s8Q5+k4JMiW3dQPQ85iyIZCK2wA4QLyy2BduRYGAJGaRvlvQnBt2BFb61EasVhAMXwO+XcO8hmVNmkxqjLW4WCVwMbDH3cMKDY9OhgaFKKJXMbbQEnmjKz+69Bqxr2Rk0gA/UIreqqePVKQzYOynQfzzH89uhUt5rl0btklUT9uFF74AyZQILjMmxHd5wnKOijLkaZF5d0Q2k2Xg5NmS2zCqwsCFZODvhFO7d7f7pjvfJDt/hyVLr+6FsFleuW5e69btdavd8JP0O7LSu+25irtEyaaPMMAN3h7hJItwCtWQGKX4jD5Xiwv29PNsu49LVyagxt6LPOvZtgfhlfKigS8/rvs4WOhTm4WeVWaSiZMPTb3wBG8QshTMpugIBBTr/xz2VOnLW4zgcXuS9ataiw4Vp6UQnqeyYvAIU1CCJ/wI8/vELNSrp7kZ8uZo4ikWhX3RbCA2slLkJ5c+NykhAaFFT2QWKTPT1AgpnuqhAMej3B+QdYRX2WgMRThPi6ufaoKOkisgpxAzLtmVV27/5AN3SKEEMTidgEUmx7lKUiB4hUXRgemDFCCttlKQt9oxwn8CNMmG9mzjKsYxz+fwzKOUVW8xA/LGN0u7Lg0E9FqN3UIOtH3IeaPuY4QNKtK7FaBf8ejLpmc3EA4pprkiF3u9GHwRe2GtSPeW0FRf/Dm/UKBvi+NYEaMXcvmgIt7W3xPaS30rXflNsj/dNesbDILQ4+dFcEDwKtB5Ucx6pBg3bZ+YTTcEFKyxkJt0Z3R2rARyhvf2Jg==',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
