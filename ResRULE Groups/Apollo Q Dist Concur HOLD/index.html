<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
