<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '0374e0f1e4493d54db403e4bd271d9b974451f866bdd9e51aaf352e4a9ecd6b5ab2e833a964549092ef0e130a26e77a565ae346a5a8e5e5b8f21873eb50c0d5c5J2VgQvITFYirT5GgoT1SvpctCtYp840akBi4WBqpgAiyWS3wz4bNgDPcWFfUJvgXVp1g3zt5dxoaigH5zoZRWP0ruQyEV+rjWTWJu/wvDGEFJqYgZEij2Jwwyz3VVA1vTa9JijWDK+Xx2BdpNh8H5FHymyJaAIDnFFSAUP4/Ma6L9OIvyEw8NrQyL2/jobZTTiZRs12cQthgK7n+D01TSnWjtsyvZ/2blatnry2z7hdcMjC2mH9ZRkrtw5RKTpUTXTpotWk7qx78IRhVh9n/D37yl2JcvLYo92DVNgJdPOeMjjx9MN7qZpWLrV2OWGbiUSzbzdpVsWogEtsxy6eSWgitp44gFh5ONQow1CowgUxrJi0dolio1LZaw2l0aKHJoThm1/TC9fCzrcf4oqlpMyVKn6U/INtV4RbJbd0P+W7D0H1PmGQRHEBWAdU2fThwRfi6nbw8HK6EyIbPbF5/sGdBYOsrRnaK5XBmwm3k4ZlCpvr4EpyC0IRPRcPgZoBDCBXFui9OqqKmzKOQ30KQAea1KnhbpkL8VDsnPChguOaA8x0/4hXuBemylVxO5FR7WqLCi+CCL3HFpHRX611751as8zHgwOc0F/mlt2uaGIb4RcN2N4womWuQr0Z4CgAyNiWhKaau4lgJYQaL9rZzQbWMRWgUoDJK5uuzOnbqySqEYORxBFTfUXaRIU14h4Or5Hlvm07o32EKLPfX/i0laXPCCeT7SV7PMN4PDHE8rJSXjVx6BkEsJFAlYSbspLJ/PYjfAjsFsXgLATorM81n+mF3u9QepeZ6diXU+6XcomD9bBEQHsrDRCcfZVpmMB0rJtMSU4p+VnpXSth4chfiVJrpBQX2VHrVFXgDFPsqVsGHZIi8fH0EkbHaZTuz2Eh5jgbFu1y7xuTn+bVuAj/+V3o6e+VTNSs/CKDrXffG1cD8QTIDhGt2D7/odAncWE9TBV0Vzx4Qcd9OQ7RpdIEH3murIKR2LL17D4qisferWjnII43E/vLfefCQlmkQEuxBNBt1HhTbpGx4x55MAKx54fhF8fsMqJ6QNqhkN1o6QBq0z3thhP0puNp+MnTJ1RXxp6kHw6ZthoE9+uA0FyyJ4sOTSBXJuHJdNafULOrxpd7zn1M7UKKxWYaqWmQ9Bxwbu97COh3vWouzGHcqittJmErXMQ645TX7SC6+nY8nAiSO4u7Jip9Wfyz3GFWb2aq7ZBmQenRufoRfwoluMsJB2cx7vXDxAX/xVifYormEISFANkBKhdGrsGCT9vrkSw2sF06CVBEaM5AXmSGcr19wEv0R6LfVBH9OuYNE4WWVHDDJlcKTDY/IhFDmwqiNygnxbuH9cljx2rl46yVAjd17HqVESUSMtUsli2R1IWX/wa11LGbgTh4+9jbM+3jM2+hiaBCac2luTVaMufL8LDC6HlHd4NfoeNBxhH9B8G1D/lpP2gLeHYdlVwOg0rgG7PFggbTmwWf6o5CVLlU+DxWwHe/Jo9yM4OzEoiSzKitwpAY8DE1MGyTV3vFW3hThge/ea6cf8V0VPItrBLc8ZSlGDG8BP7aj7dGv1+bP8bz0CWhVyD2MnJkA+is6dg+Yuf5JXNuye0dLz29LJvdU2DVawvIeEe3C1yU4rX/BDhGcAWZiVRLdX1UNr9upQMaKbsfpJn/bGcmzUB+Ho1mSbhBoe178W6RTlSACvhP+jpJsW3kd91Nz2TD5A6eiqHTXjVfMAysUArNJYjZHP2V3pHPwrRaa+ZbeJCl6FDoKenbYnLRjqb4AuGpfr22Z8J5tSeQmX+v7fhQl2QHz/clj8nA+zFzthnlDN//oTmuMSA2dl8rLP+LHhn5Pxi2Apw4LiSCIs/31DIXnLsATgPxunrWA4UqEGOm9o3+Enyzy1eAQSwOqkDU0QfTNq8V5ESCaUvj4DiWmrXVHy+djpBtEeIgSlQyNdvhgVtkHm+/Z9Zu1Zpdb8w4lI9f6nKvkVG2pn/5Xr9dFa4TUnSt3yx/fRsyRV4XzBTN0KPftORuHUCHmB8/0VdQ67ytdNWr5FleS6+CsKhLYy9cKZT+YJ8f76IYgDJqDstCV6m+CHAbw9MpGs9u21d5WaeAHESTfo6PNwDLlo3aw8qRGByts6IhgRKHCqvqCNIbVX3oEt8VrJqqaPRBqQbe0dTkOyRaJ4W7PNEjH9G7qCgV8H7BTbEo4xE1iFznA+iqM6pTAmD5PPeRpT+fczAQPD2YvDgpLYE1YAzT6xl/NYqrISzm4KvJr4fpqk3qdZBPuidnjraA6MKToX6KSNeyDc7KGTHdX3mrwl9UIffmkQOT7Lmv4feGONaxB8VmW3UO5dsisL7y0QFbsUMBVpwDcl5rzTVvL5MoRtxxYT9tE5lnNI4KRDYvkVe1bBKMtG5e9be9yCmBwpLs/rt9GStalpEP+iU5ZXQ7tHh+wwm9wIYOG793/XTbMOLl6P7GJLlKebE0dApOTjWeC8jY4dy8r/edjdO7hxV4TfPCngdKmxoNb1l6YaESiGjwzUsfc6y8lws4mLxzyvEzRDGl43apHi19yQ0/aN3GqjPECYmmtRdenQPA/Ahq0oZKWAw9S/hvTjuKwgJzzcq02a2BK93bXaD60Ktt4AgenCOwWRuwSI3ZJ4lq+PG2+q678u3DtTND8XvF50yCviK9dKzCqauOpez+KeBkywCoQ2Uz0KDpDHRuPEaNKN4a4tInB97ECTkVLw+0FcbecVRx3iPIrhUUu8xwhpSJFrO90MgNFa9a4J2x23wevI0vUlHNoDeJD6pYWn8u806FrACY0S399yNwZLB15WPEAJlIgEQZ37tcE6ZYPVa0LoGWOjOdE+FPFcSS0KqHdIMEYlyGgxNBfQ0WCxaj8nXwIvK7C07eY8XaWQVYzbOE3s4D81JaCDJy4PqaBOetMEW47/e7gBTcyBwiHdoEJBc/kjWsMkJbE0IhiOcD9vUaDrD4CkA+IA8ydmrtbornbo9WiozLSIN3D/vGwOo6RUj8qGU2SjW85+Ql8oMCBC3nfHzx0vrHOnJL/8GTXYBO3mpRBzrU3ImLhQQI/6MsWJbUB5A56ZzfzYHz2TASKTysmxVG1zT3X2B0X3qQRK8C5qH5vvLVce/TMoWEgwuaIaymykGlcScBkB1JgvNpgzn/SyMuz1BctuyCQ9gVdFtxaf2FyteZqqFkNNq0Na4kxs0sd07shpLNdzR+rRgQcXB7rCMhVCwiGMEBsnMuDHPOv1UhXsZ7cgOrtOCHLfDrrw2GqfHG1QbW2EGPBC4fWFwhsM97WrqWId+/vVFMAzpWq1xedXm0lzBgc3zn/3LSvkV6ZFTN2rU/LG6AtymD27MY5LgPZvV9dVKqRSlNXIQsGgW549cxDSHjfYyxN57bmjKJbZzwWBUKzu19FPmGuO5roSObZ/ebf78QlGDUaXyk2MfiBIsDJBAC7e3PYZCgdV1qzH6jTRzJ68PH1CKItUVtBgRiVJAv4WqIgbbAHgU2ethECQcUJNKAWTR1omBK7dW/bdgq/G2HotOUDd6jWAx1lJ/ZZRqcx99n7bdyqZDjrcLVEJZqOgomO8E34ftPDlJLAHX/HK5/XTrEfrjm1hbUQqI19MJWuJlic81llIsElobeGV4aFh52gxjAYtWYeR2DUs1z6ZBp3vo8egIwIXEUkRs/jx35PY8IQhe1CFhvRA86+u51JLwxtzGB+mBdmO7j1OfDi7E47pMYSQOFas/Q/b94UzHRsMTF0iJ10mAzzOqj8fq/bkaz+Mwwfrg664og+nLYNjy9nAfucVQnk/01c7GIsTfP0LOMlOLftr4D60rABMSd2gdR+o6sPG+RKqtjY7zGhCFEOHx0rJ9Oej/VFitY6l5JHlP6hJF4htErd3/eqKkHyke9R+1iHGQOfnFsdgUXjXleS6ZBuFjcc1NaGK93ufj0628sYfFp9V1G5CoVUN4rLUFiGdtgZlBfuZGLCVAXUym/FPmeg2IA7Z+a3dTzTmBw/ixCUkZ/Nc3WzLPlFZFgC1NTlNwd/iMLuMowolS2TdUldA1CbMtR9JuIzXy2tCMfHbhsTDcdH/zgmo2R87OtOkOCQq20crhplpUWD2vwizDUKducNHLE2RQKedc/KdUpOSCDK3cCA4dUzmceoJ0e4owu2N5PEXencQjgI+mzMNR64q/Iqjv6lqvQcG5OouXBSC16erf06BKRq8tTFjkZvs4eLpEyxyDala3525P/aO9WLSp28+fwI++BTfvwanrxWihmLpehM2Cviu/Z/mtXNb2gtAYLarZSLdYq6RQKCcGEfywFUGygWd3arN0dFxRVdgcmsfn1s1SB7pLlOgF2Q6oM45Bg3+mIctIWN3ZMOpkH3xUqPpaTG8Vqh9blnj/632zeBe/Q+zADCWCg2ZFCzAnIdJHY30vBz0tu/fUwYgdrR6oea95BhS9WBPZM8lqy3LI/d+epW4rbU2Gv1DGXXRcT3bNQ7dcG3dCYhNQg8PX/+frUcpOrccRnoFor6rTBejoSmxHpVuInvIQ0CaUjqo9PCEUP6WrK3nyZBRyR020m32uE0OFV85WcgatqUDY35KtveK8mJ8Ctc1tPBsALdmgf5Y8OFzVAEWROysvFwHjwacB7BS5/RSygTNbBOzh9fFaCZZbJDNvJRGmDdhfbRYD/fe7DKE2XPSVhVz/7GL9Z0k0psZI2jnQc2lZNQQEeeYKayGhMwQ3eJg7iodlwogVPn8V1GEpgnW3oEEHBvQgnsJHWgxu3eHyPF2x7FVXVCrR8b5o1JZ56nCxT5bkWhRxoOA/a1K6STwVyhPtZCaFOCt4cCVfM/Gu12OTI+ipOPlOx0CZOFh9pyrCfF3RXmefTqZisED5wJxuj8kz7hsYovNodSosGG7qZG3TGofjUBMs7YGZwgvKJhem/UFH/Sv5bb0Ialg/KDMH6kGBL8jzxybRbYtK1LJPDw6VwnpCsqbOMYo4AJdDMQXDxxDVCi0cdbPQCJTgE9SWBk+c0R7mtiLoxUV3rLrmxo06gpTzKq7SiC1u7Ve22EmztgpNJ9/OXxp6e1X2IiuaQWpKsOZMgT5SDbTebm/Kn8AAS4LZhNbU9/sICkbw+a6PdLkH/w+uG9uKl2dHczqgFP8M1Dk+t9yp0I1t21X5WgMl/4lj8EtRnwb4cq0/uFfVY/wMf5mOfPLL09yWCVupe5/PYRMaLXJl/y4MkjiUUhZjxpPFoT089YLpba0nqIo3JV6jyoNe35dqUsby2n61fYiHe4qx8cWRjRGWDMb/W7A85KX39iXWyacKhYT/sSvgFdC93KiILmXioicAitBoigDVtWzphqTQi/iqKygyY+pXRDuYt++XdvxJgfB9BDfPcYoScOb4hZulygbL8ipRapOZC4koQvd249Io1MLGNAEI+wOhEsOAkaF8HT7RAzn5yBqFbgIAS9y6pQdTPiQ4Kra1p9zCCmrlKz433/mWox+7YwEg5P2kjdklueRL6UgSpYp5ow2ec7KOCJUPTx7tPNR58IoeCcb0Th9KS1wUjgbWEfix8km0DkYmzlSy9fJn6Xh/xnCCzYHCQohwq+W5imrBH/UoHmYtUROqWfyueRtXpEGkkW758Z7HjrASyqrEBq0/xOxAwwLAp8NNo6bFMjXo0aSVqt/ph4xoPJFIihgKNB8oBBIw7wIxSKLQBGvzoNFR6mR8yV35GapFKpyZc0C4gBa1UpurHtG8GK1ROba8MwAOcrrdsj2fbPjuSRbZnX5BnO8Qw6z6nmFK/P4rp6zUxiVB/UTFVgceosI4NEHE1WJp0NycF52yq+kdB0rJVwUbm5AyqSKKpda+2jObn37CvGBL4x+OJoPZgc/bPpnMo0xVtPQcrFZAAsi84epsf7lbAM1GEP5iCBzG5EG8QZY4e7tAX+M4wbCyijXM3kf2eCbavRTG8FIcmV3IUZUw/PkWEDdhjs/eyvzcOKh+2bgMWPA7/BaV0NeoHqXnSLys1RVOlbxfuRYJth+v3gotbLl69yMhR+Sg4g/gxY9zaTlld72QjXJ/bX8gMvb4kPULm/W4twR5ETNJJ1cHBC/e7UdjQIkU7TgcxRhJ4aB4Bod7kUqIxY38KlEzuZU64ZRnkJ6y7mtgKRygYu95ekssdefsnO0g=',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
