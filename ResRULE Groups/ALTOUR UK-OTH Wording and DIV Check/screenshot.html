<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '536436749cb1df90cbb283e3dc30f85edef957405f5f7ff91978a7a18de3f151952978cda22e7470c7009f11564f3dcba9accbb1bd26f3373a81bb4634f8173a53DyNhDEzbNNoHN0LpG84ay8VO88h37Mgqt+ReFMTuWevdytr1iARrIZNDHXhSF5YguhUuBcmssX/jVA8oyWhmjttY1sGyjh2DramQSwwPK6qZl77xsVtQrZH9phLiDQ/YG1r8sl57AnrdAbnETHNgMlsl2awTK6CT1jmaunKK204Mn82XY/i0S7rtrFeZa9jZD80VmKxcnJ1hap3heWk1oHb2tOMoycZgNsvFLBqEcL8LaB/46EHbBNgH/U+4o79OSM84UHX7Wp2aaZyPAaoKcn1or4HmR+Fn4k72CXAdfwXPt474hbvrfViwI7cgNnb4WEPJfqYvg9Bk/X7QeguYVWSIw3IPdAieUaM3efdR1vHZdnXskDEo+yaIzflyardL/d1N6i2JF2HWzaG+mIyReR3lc1oXBoxyXx9k7su7usfM3eIP820cy8QCZVifj3rzgjGkhhmKFXVIlZOEStjYQ3WqyTgANeIb+xmo3aJoLr3/yR7tAs8CHd4uHRg3f8bNqMcN8zY66qXdaILxZdNGH9MNiJ4Wmj33T6bdZbNxwY0b317WXPZgs8kGKKN75WtwPPkMrZ0dwzUxTkgHyV7YGWjdLZ5BU1gwRmNUKZy0z0vTtNHC48cV3qM3Z03XkJvawfddhxIe218pvuiqFK6q+rTs4KKs433vvx5/90l3dvGbrHr/HME4wuUXDIT9EfRc+F0/AnePiXbvOyb3EkyIBQy5L9s11c5zM/lNxsJynYnhvpsqgY67kQrbP7qZkJTlCCRQw3zaf1dIPrjR3itvRLVOLdkvRYP3ZpyEOeg5pwiCdilRu5vT8TpU2SLWSIlTTK/2JlNMyR8iKEiJhk+Vwkjl2NBfkwMr5hLXgOJxozsovHGzN8aTe0u8oym9qFPXupN/L8HiHYo3cSpPO+1Z/bhCcqfLQ4se9hfK3pMPAITzVYHnBFz7P9w81XBO5J3X+Frblw/NeMuWCaVDUPNwXqyf1hqq/1l8cjWAosTVlr5tKnkLJwv3ubN9tWF9P2wLuB8gAwO30mg7oP9wqCVecc42WKXbyaTbqv7TcRmbpb9INq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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
