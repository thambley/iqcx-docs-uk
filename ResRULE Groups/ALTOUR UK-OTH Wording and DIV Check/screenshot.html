<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: none;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        document.querySelector(".staticrypt-body").style.display = "block";
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
