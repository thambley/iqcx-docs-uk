<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
