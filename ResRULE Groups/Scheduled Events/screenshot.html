<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
