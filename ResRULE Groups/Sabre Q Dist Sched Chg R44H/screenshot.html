<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!')
                    return
                }
            })
        }
    }

    if (passphraseStorage && passphraseStorage.get()) {
        if (!decryptWithPassphrase(passphraseStorage.get())) {
            passphraseStorage.remove()
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.getElementsByTagName("html")[0].innerHTML = plainHTML;

        return true;
    };
</script>
</body>
</html>
