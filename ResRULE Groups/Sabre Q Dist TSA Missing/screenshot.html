<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        .staticrypt-footer {
            position: fixed;
            height: 20px;
            font-size: 16px;
            padding: 2px;
            bottom: 0;
            left: 0;
            right: 0;
            margin-bottom: 0;
        }

        .staticrypt-footer p {
            margin: 2px;
            text-align: center;
            float: right;
        }

        .staticrypt-footer a {
            text-decoration: none;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <p class="staticrypt-title">Protected Page</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>
<footer class="staticrypt-footer">
    <p class="pull-right">Created with <a href="https://robinmoisson.github.io/staticrypt">StatiCrypt</a></p>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script> var storageType = "localStorage" 
function passphraseStorageFactory (storageType) {
    return {
        store: function (passphrase) {
            return window[storageType].setItem("passphrase", passphrase)
        },
        get: function () {
            return window[storageType].getItem("passphrase")
        },
        remove: function () {
            return window[storageType].removeItem("passphrase")
        }
    }
}

const passphraseStorage = passphraseStorageFactory(storageType)</script>

<script>
    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    window.onload = function () {
        if (passphraseStorage && passphraseStorage.get()) {
            if (decryptWithPassphrase(passphraseStorage.get())) {
                return;
            } else {
                passphraseStorage.remove();
            }
        }

        var form = document.getElementById('staticrypt-form')
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault()
                var passphrase = document.getElementById('staticrypt-password').value
                passphraseStorage && passphraseStorage.store(passphrase)
                if (!decryptWithPassphrase(passphrase)) {
                    alert('Bad passphrase!');
                    return;
                }
            })
        }
    }

    function decryptWithPassphrase(passphrase) {
        var encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);
        document.write(plainHTML);
		document.close();

        return true;
    };
</script>
</body>
</html>
